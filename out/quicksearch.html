<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"src_arithmetic_AutoSeatPicking.js.html":{"id":"src_arithmetic_AutoSeatPicking.js.html","title":"Source: src/arithmetic/AutoSeatPicking.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/arithmetic/AutoSeatPicking.js /** * Created by cuppi on 2016/12/21. */ // 项目甲方公司人员并存在抄袭想法观看这段代码会在↑时间开始的一年里发生不好的事情的 // 我说话一向蛮准的 // 对 这就是赤果果的诅咒 -.- // 此代码开源的 外人随便看 并希望大家对开源献出自己的一份力量 // 此代码有很多需优化的细节... 遍历顺序，时间复杂度，可定制型什么的... balabala... 时间来不及了... // import _ from 'lodash'; let instance = null; class AutoSeatPicking { constructor() { if (!instance) { this.needSeatCount = 0; this.rowCount = 0; this.colCount = 0; this.minRow = Number.POSITIVE_INFINITY; this.minCol = Number.POSITIVE_INFINITY; this.seatMap = []; this.seatModelMap = []; instance = this; this.resultCallback = null; } return instance; } static defaultManager() { return new AutoSeatPicking(); } /** * 创建快捷座位简图 * @param smartSeats 目标座位图 */ createSeatMap(smartSeats) { let maxRow = 0; let maxCol = 0; let minRow = Number.POSITIVE_INFINITY; let minCol = Number.POSITIVE_INFINITY; for (let seat of smartSeats) { maxRow = Math.max(seat.row, maxRow); maxCol = Math.max(seat.col, maxCol); minRow = Math.min(seat.row, minRow); minCol = Math.min(seat.col, minCol); } for (let i = 0; i &lt;= maxRow; i++) { this.seatMap[i] = []; this.seatModelMap[i] = []; for (let j = 0; j &lt;= maxCol; j++) { this.seatMap[i][j] = '_'; this.seatModelMap[i][j] = {}; } } for (let seat of smartSeats) { this.seatModelMap[seat.row][seat.col] = seat; if (seat.status === 0 &amp;&amp; (seat.loveIndex === 0 || isNaN(seat.loveIndex))) { this.seatMap[seat.row][seat.col] = '0'; } else { this.seatMap[seat.row][seat.col] = '1'; } } this.rowCount = maxRow + 1; this.colCount = maxCol + 1; this.minRow = minRow; this.minCol = minCol; } /** * 一层一层寻找最佳位置 * @param smartSeats 目标座位图 * @param count 期望最佳位置的数量 * @param resultCallback 结果回调 */ autoSelected(smartSeats, count, resultCallback) { this.createSeatMap(smartSeats); this.needSeatCount = count; this.resultCallback = resultCallback; let rowLength = (this.rowCount - this.minRow); let colLength = (this.colCount - this.minCol); for (let i = 0; i &lt;= Math.max(parseInt(this.rowCount / 2), parseInt(this.colCount / 2)); i++) { if (this.targetFromRowColTier(parseInt(rowLength / 2) + this.minRow, parseInt(colLength / 2) + this.minCol, i)) { break; } } } /** * 判断指定层是否存在最佳位置 * @param row 指定点行 * @param col 指定点列 * @param tier 层数 * @returns {boolean} 是否存在最佳位置 */ targetFromRowColTier(row, col, tier) { for (let i = 0; i &lt;= tier; i++) { if (this.targetFromRowColInnerOffsetTier(row, col, i, tier)) { return true; } } return false; } /** * 判断指定点的期望结果 * @param row 指定点行 * @param col 指定点列 * @param innerOffset 行内偏移 * @param tier 层索引 * @returns {boolean} 是否存在 */ targetFromRowColInnerOffsetTier(row, col, innerOffset, tier) { let rowSignTimes = (innerOffset !== 0) + 0; for (let rowSign = -1; rowSign &lt;= rowSignTimes; rowSign++) { if (!rowSign) { continue; } let colSignTimes = (tier !== 0) + 0; for (let colSign = -1; colSign &lt;= colSignTimes; colSign++) { if (!colSign) { continue; } let changeTimes = (innerOffset !== tier) + 0; for (let change = 0; change &lt;= changeTimes; change++) { let rowOffset, colOffset; if (change) { rowOffset = tier * colSign; colOffset = innerOffset * rowSign; } else { rowOffset = innerOffset * rowSign; colOffset = tier * colSign; } let resultRow = row + rowOffset; let resultCol = col + colOffset; if (resultRow &lt; 0 || resultCol &lt; 0 || resultRow &gt;= this.rowCount || resultCol &gt;= this.colCount) { // console.log('内存溢出'); return false; } if (this.seatMap[resultRow][resultCol] === '0') { let result = this.checkVisibleSeatAtRowColMiddleOffsetCount(resultRow, resultCol, this.needSeatCount); if (result.length === this.needSeatCount) { let resultMap = new Map(); for (let integer of result) { let row = parseInt(integer / this.colCount); let col = integer % this.colCount; let key = row + ':' + col; let value = this.seatModelMap[row][col]; resultMap.set(key, value); // [self selectedSeatRow:integer/this.colCount col:integer%this.rowCount]; } if (this.resultCallback) { this.resultCallback(resultMap); } return true; } } } } } return false; } /** * 判断指定点的所有行内偏移的结果 * @param row 指定点行 * @param col 指定点列 * @param count 当前查找的数量(后期需要优化) * @returns {*} 是否存在期望点 */ checkVisibleSeatAtRowColMiddleOffsetCount(row, col, count) { if (col &gt;= this.colCount || col &lt; 0) { return []; } // 当期望是一个点的时候 if (count === 1) { if (this.seatMap[row][col] === '0') { return [this.integerAt(row, col)]; } return []; } // i为遍历偏移量 （目前是从左到右) for (let i = 0; i &lt;= parseInt(count / 2); i++) { let result = []; for (let j = 0; j &lt; this.needSeatCount; j++) { result = result.concat(this.checkVisibleSeatAtRowColMiddleOffsetCount(row, col + i - parseInt(this.needSeatCount / 2) + j, 1)); } if (result.length === this.needSeatCount) { return result; } if (i &lt;= parseInt((count - 1) / 2)) { result = []; for (let j = 0; j &lt; this.needSeatCount; j++) { result = result.concat(this.checkVisibleSeatAtRowColMiddleOffsetCount(row, col - i - parseInt(this.needSeatCount / 2) + j, 1)) } if (result.length === this.needSeatCount) { return result; } } } return []; } /** * 二维转一维 * @param row 行号 * @param col 列好 * @returns {*} 一维对应的映射 */ integerAt(row, col) { return row * this.colCount + col; } } export default AutoSeatPicking; × Search results Close "},"src_differentiation_icbc.url.config.js.html":{"id":"src_differentiation_icbc.url.config.js.html","title":"Source: src/differentiation/icbc.url.config.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/differentiation/icbc.url.config.js /** * Created by cuppi on 2017/5/12. */ const cityUrl = { jbzCities: '/location/cities', jbzCityByCoordinate: '/location/city', jbzCityById: '/location/citybyid', jbzDistricts: '/location/districts', jbzHotCities: '/location/hotcities' }; const cinemaUrl = { jbzList: '/cinema/cinemas', jbzDetail: '/cinema/cinemaDetail', jbzScreeningFilmList: '/cinema/films', jbzScreeningDateList: '/cinema/filmshowdates', jbzScreeningItems: '/cinema/filmshows', jbzRealtimeSeat: '/cinema/realtimeseats' }; const filmUrl = { jbzHotFilms: '/film/hotFilms', jbzHotFilmsPage: '/film/hotFilmsPage', jbzHotFilmsSimple: '/film/hotFilmsSimple', jbzWaitFilms: '/film/upcomingFilms', jbzWaitFilmsPage: '/film/upcomingFilmsPage', jbzFilmDetailByPartner: '/film/filmByPartner', jbzFilmDetail: '/film/film', jbzFilmDate: '/film/filmDate' }; const accountUrl = { jbzLogin: '/account/login', jbzLogout: '/account/logout', jbzVerifycode: '/account/verifycode', jbzRegister: '/account/register', jbzUpdatepass: '/account/updatepass' }; const tradeUrl = { jbzLockSeat: '/order/lockseat', // jbzAppApplyTicket: '/appapi/applyticket', jbzWebAtAppApplyTicket: '/order/applyticket', // jbzCancelOrder: '/main/cancelOrder', // jbzAppPrepay: '/webapi/prepay', // jbzWebPrepay: '/appapi/prepay', }; const otherUrl = { jbzBanners: '/banner/banner', jbzSearch: '/main/search' }; export default {cityUrl, cinemaUrl, filmUrl, accountUrl, tradeUrl, otherUrl}; × Search results Close "},"src_differentiation_shanghai.url.config.js.html":{"id":"src_differentiation_shanghai.url.config.js.html","title":"Source: src/differentiation/shanghai.url.config.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/differentiation/shanghai.url.config.js /** * Created by cuppi on 2017/5/12. */ const cityUrl = { jbzCities: '/location/cities', jbzCityByCoordinate: '/location/city', jbzCityById: '/location/citybyid', jbzDistricts: '/location/districts', jbzHotCities: '/location/hotcities' }; const cinemaUrl = { jbzList: '/cinema/cinemas', jbzDetail: '/cinema/cinemadetail', jbzScreeningFilmList: '/cinema/films', jbzScreeningDateList: '/cinema/filmshowdates', jbzScreeningItems: '/cinema/filmshows', jbzRealtimeSeat: '/cinema/realtimeseats' }; const filmUrl = { jbzHotFilms: '/film/hotfilms', jbzHotFilmsPage: '/film/hotfilmspage', jbzHotFilmsSimple: '/film/hotfilmssimple', jbzWaitFilms: '/film/upcomingfilms', jbzWaitFilmsPage: '/film/upcomingfilmspage', jbzFilmDetailByPartner: '/film/filmbypartner', jbzFilmDetail: '/film/film', jbzFilmDate: '/film/filmdate' }; const accountUrl = { jbzLogin: '/account/login', jbzLogout: '/account/logout', jbzVerifycode: '/account/verifycode', jbzRegister: '/account/register', jbzUpdatepass: '/account/updatepass' }; const tradeUrl = { jbzLockSeat: '/order/lockseat', // jbzAppApplyTicket: '/order/confirmorder' jbzWebAtAppApplyTicket: '/order/confirmorder', // jbzCancelOrder: '/main/cancelOrder', // jbzAppPrepay: '/webapi/prepay', // jbzWebPrepay: '/appapi/prepay', }; const otherUrl = { jbzBanners: '/banner/banners', jbzSearch: '/main/search' }; export default {cityUrl, cinemaUrl, filmUrl, accountUrl, tradeUrl, otherUrl}; × Search results Close "},"index.js.html":{"id":"index.js.html","title":"Source: index.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: index.js /** * Created by cuppi on 2017/4/14. */ module.exports = require('./dist'); × Search results Close "},"src_network_JNetwork.js.html":{"id":"src_network_JNetwork.js.html","title":"Source: src/network/JNetwork.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetwork.js /** * Created by cuppi on 2016/11/22. */ 'use strict'; import axios from 'axios'; import UrlTool from '../tool/JToolUrl.js'; /** * 网络请求类 * @alias network/JNetwork */ class JNetwork { static baseUrl = ''; static timeout = 10 * 1000; static delegate = null; static inType = ''; /** * 需要定位的请求的公共参数 * @private * @returns {*} */ static locationParas() { if (this.delegate) { let cityParas = this.delegate.cityParas(); let coordinateParas = this.delegate.coordinateParas(); return { cityId: cityParas.id, longitude: coordinateParas.longitude, latitude: coordinateParas.latitude }; } return {}; } /** * 需要登录的请求的公共参数 * @private * @returns {*} */ static loginParas() { if (this.delegate) { let loginParas = this.delegate.loginParas(); if (loginParas &amp;&amp; loginParas.hasAccount) { return { sessionId: loginParas.sessionId, openId: loginParas.mobile, mobile: loginParas.mobile, hasAccount: true }; } } return { hasAccount: false }; } // static inType(){ // return this.delegate.inType(); // } // static inType() { // let intype = ''; // // if (Platform.OS === 'android'){ // // intype = 'DPANDROID'; // // } // return intype; // } static failedAuthorizationNetwork(){ return new Promise((resolve, reject) =&gt; { reject(new Error('authorization error')); }); } static unrealizedMethod(){ return new Promise((resolve, reject) =&gt; { reject(new Error('unrealized method')); }); } static wrongInType(){ return new Promise((resolve, reject) =&gt; { reject(new Error('the inType is not exist, please check your inType property in JBZConfig')); }); } /** * 包裹可取消的请求 （使用fetch请求时使用，目前通过axios请求，无需使用） * @private * @param promise 异步请求块 * @returns {*} 被包裹后的异步请求块 */ static wrapCancelablePromise(promise) { let hasCanceled_ = false; const wrappedPromise = new Promise((resolve, reject) =&gt; { promise.then((val) =&gt; hasCanceled_ ? () =&gt; { } : resolve(val), () =&gt; { // 不写会有警告 }); promise.catch((error) =&gt; hasCanceled_ ? () =&gt; { } : reject(error)); }); return { terminate () { hasCanceled_ = true; }, then (resolve, reject) { return wrappedPromise.then(resolve, reject); } }; } /** * post请求 * @param url 相对地址 * @param parameters 地址参数 * @param headers 头参数 * @returns {{terminate, then}|*} 异步请求块 */ static POST(url, parameters, headers) { let isOk; return this.wrapCancelablePromise(new Promise((resolve, reject) =&gt; { let iHeaders = Object.assign({ 'Accept': 'application/json', 'Content-Type': 'application/json' }, headers); if (headers) { // console.log(iHeaders) } console.log('POST ' + UrlTool.urlFromPortion(this.baseUrl, url, parameters)); axios(url, { timeout: this.timeout, method: 'post', baseURL: this.baseUrl, headers: iHeaders, params: {...parameters, inType: this.inType} }).then((response) =&gt; { isOk = response.status === 200; return response.data; }).then((responseJson) =&gt; { if (isOk) { if (!responseJson.errorCode) { resolve(responseJson.data); } else { if (responseJson.errorCode === 10022) { reject(new Error('NotLogin')); } else { reject(new Error(responseJson.message)); } } } else { reject(responseJson); } }).catch(error =&gt; { // 请求超时 if (error.message.indexOf('timeout' !== -1)) { reject(new Error('请求超时, 请稍后重试')); } else { reject(error); } }); })); } /** * get请求 * @param {string} url 相对地址 * @param {string} parameters 地址参数 * @param {string} headers 头参数 * @returns {Promise} 异步请求块 */ static GET(url, parameters, headers) { let isOk; return this.wrapCancelablePromise(new Promise((resolve, reject) =&gt; { let iHeaders = Object.assign({ 'Accept': 'application/json', 'Content-Type': 'application/json' }, headers); if (headers) { // console.log(iHeaders) } console.log('GET ' + UrlTool.urlFromPortion(this.baseUrl, url, parameters)); axios(url, { timeout: this.timeout, method: 'get', baseURL: this.baseUrl, headers: iHeaders, params: {...parameters, inType: this.inType} }).then((response) =&gt; { isOk = response.status === 200; return response.data; }).then((responseJson) =&gt; { if (isOk) { if (!responseJson.errorCode) { resolve(responseJson.data); } else { if (responseJson.errorCode === 10022) { reject(new Error('NotLogin')); } else { reject(new Error(responseJson.message)); } } } else { reject(responseJson); } }).catch(error =&gt; { // 请求超时 if (error.message.indexOf('timeout' !== -1)) { reject(new Error('请求超时, 请稍后重试')); } else { reject(error); } }); })); } } export default JNetwork; × Search results Close "},"src_network_JNetworkAccount.js.html":{"id":"src_network_JNetworkAccount.js.html","title":"Source: src/network/JNetworkAccount.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkAccount.js /** * Created by cuppi on 2017/3/6. */ 'use strict'; import JNetwork from './JNetwork.js'; import {accountUrl} from '../unify/JUrlList'; /** * 账户接口 * @alias network/JNetworkAccount */ class JNetworkAccount{ /** * 用户登录 * @param mobile 登录需要的手机号码 * @param password 登录需要的密码 * @returns {{terminate, then}|*} */ static accountLogin(mobile, password) { return JNetwork.POST(accountUrl.jbzLogin, { mobile: mobile, password: password }); } /** * 用户登出 * @param sessionId 用户登录标识 * @returns {{terminate, then}|*} */ static accountLogout(sessionId) { return JNetwork.POST(accountUrl.jbzLogout, {}, sessionId); } /** * 获取验证码 * @param mobile 接收验证码的手机号码 * @param type 验证码类型 （1：注册使用 2：忘记密码使用） * @returns {{terminate, then}|*} */ static accountVerifyCode(mobile, type) { return JNetwork.POST(accountUrl.jbzVerifycode, { mobile: mobile, codetype: type }); } /** * 注册用户 * @param mobile 用户的手机号码 * @param verifyCode 验证码 * @param password 密码 * @returns {{terminate, then}|*} */ static accountRegister(mobile, verifyCode, password) { return JNetwork.POST(accountUrl.jbzRegister, { mobile: mobile, verifyCode: verifyCode, password: password }); } /** * 忘记密码并且找回密码 * @param mobile 手机号码 * @param verfyCode 验证码 * @param password 新密码 * @returns {{terminate, then}|*} */ static accountUpdatepass(mobile, verfyCode, password) { return JNetwork.POST(accountUrl.jbzUpdatepass, { mobile: mobile, verifyCode: verfyCode, password: password }); } } export default JNetworkAccount; × Search results Close "},"src_network_JNetworkCinema.js.html":{"id":"src_network_JNetworkCinema.js.html","title":"Source: src/network/JNetworkCinema.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkCinema.js /** * Created by cuppi on 2016/11/29. */ 'use strict'; import JNetwork from './JNetwork.js'; import {cinemaUrl} from '../unify/JUrlList'; import DateTool from '../tool/JToolDate'; import _ from '../unify/JDataUnify'; import SeatManager from '../util/JManagerSeat'; /** * 影院接口 * @alias network/JNetworkCinema */ class JNetworkCinema { /** * 获取影院详情 * @param cinemaId 影院ID * @returns {*} */ static cinemaDetail(cinemaId) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cinemaUrl.jbzDetail, {cinemaId}).then(data =&gt; { resolve(_('cinemaUrl.jbzDetail', data)); }, error =&gt; { reject(error); }); }); } /** * 影院列表 * @param location * @param cinemaFilter * @returns {Promise} */ static cinemaList(location, cinemaFilter) { return new Promise((resolve, reject) =&gt; { let {filmId, feature, region, sort, limit} = cinemaFilter ? cinemaFilter : {}; JNetwork.POST(cinemaUrl.jbzList, { ...location, filmId, feature, regionName: region, orderType: sort, limit }).then(data =&gt; { resolve(_('cinemaUrl.jbzList', data)); }, error =&gt; { reject(error); }); }); } /** * 影院列表 * @param cinemaFilter 影片筛选条件 * @returns {{terminate, then}|*} */ static cinemaListNeedLocation(cinemaFilter) { let location = JNetwork.locationParas(); return JNetworkCinema.cinemaList(location, cinemaFilter) } /** * 获取指定影院排片 * @param cinemaId 影院Id * @returns {{terminate, then}|*} */ static cinemaScreeningFilmList(cinemaId) { let loginParas = JNetwork.loginParas(); let account = {}; if (loginParas.hasAccount) { account = {openId: loginParas.openId, sessionId: loginParas.sessionId}; } return new Promise((resolve, reject) =&gt; { return JNetwork.POST(cinemaUrl.jbzScreeningFilmList, { cinemaId }, account).then(data =&gt; { resolve(_('cinemaUrl.jbzScreeningFilmList', data)); }, error =&gt; { reject(error); }); }); } /** * 获取指定影院排片日期安排 * @param cinemaId 影院Id * @param filmId 影片Id * @returns {{terminate, then}|*} */ static cinemaScreeningDateList(cinemaId, filmId) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cinemaUrl.jbzScreeningDateList, {cinemaId, filmId}).then(data =&gt; { resolve(_('cinemaUrl.jbzScreeningDateList', data)); }, error =&gt; { reject(error); }); }); } /** * 获取指定影院排片放映厅安排 * @param cinemaId 影院Id * @param filmId 影片Id * @param date 日期（时间戳标示） * @returns {{terminate, then}|*} */ static cinemaScreeningItems(cinemaId, filmId, date) { return new Promise((resolve, reject) =&gt; { date = DateTool.dateStringFromTimeInterval(date, 'yyyy-MM-dd'); JNetwork.POST(cinemaUrl.jbzScreeningItems, {cinemaId, filmId, date}).then(data =&gt; { resolve(_('cinemaUrl.jbzScreeningItems', data)); }, error =&gt; { reject(error); }); }); }; /** * 实时座位图 * @param type 平台类型 （必须） * @param paras （根据不同平台变化） * @returns {*} */ static cinemaSeats(type, paras) { if (type === 'meituan' || type === 'dazhong') { type = 'maoyan'; } return new Promise((resolve, reject) =&gt; { JNetwork.POST(cinemaUrl.jbzRealtimeSeat, {type, ...paras}).then(data =&gt; { resolve(_('cinemaUrl.jbzRealtimeSeat', data)); }, error =&gt; { reject(error); }); }); } /** * 智能实时座位图 * @param type 平台类型 （必须） * @param paras （根据不同平台变化） * @returns {*} */ static cinemaSmartSeats(type, paras) { if (type === 'meituan' || type === 'dazhong') { type = 'maoyan'; } return new Promise((resolve, reject) =&gt; { JNetwork.POST(cinemaUrl.jbzRealtimeSeat, {type, ...paras}).then(data =&gt; { resolve(SeatManager.defaultManager().smartSeatsFromSeats(type, _('cinemaUrl.jbzRealtimeSmartSeat', data))); }, error =&gt; { reject(error); }); }); } /** * 收藏影院 * @param cinemaId 影院Id * @param cinemaName 影院名字 * @returns {{terminate, then}|*} */ static cinemaFavoriteCinemaNeedLogin(cinemaId, cinemaName) { let loginParas = JNetwork.loginParas(); if (!loginParas.hasAccount) { return JNetwork.failedAuthorizationNetwork(); } return JNetwork.POST(cinemaUrl.jbzCollectcinema, { openId: loginParas.openId, cinemaId: cinemaId, cinemaName: cinemaName }, { 'sessionId': loginParas.sessionId }); } /** * 取消收藏影院 * @param cinemaId 影院Id * @returns {{terminate, then}|*} */ static cinemaCancelFavoriteCinemaNeedLogin(cinemaId) { let loginParas = JNetwork.loginParas(); if (!loginParas.hasAccount) { return JNetwork.failedAuthorizationNetwork(); } return JNetwork.POST(cinemaUrl.jbzCancelcollectcinema, { openId: loginParas.openId, cinemaId: cinemaId }, { 'sessionId': loginParas.sessionId }); } } export default JNetworkCinema; × Search results Close "},"src_network_JNetworkCity.js.html":{"id":"src_network_JNetworkCity.js.html","title":"Source: src/network/JNetworkCity.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkCity.js /** * Created by cuppi on 2016/11/30. */ 'use strict'; import JNetwork from './JNetwork'; import {cityUrl} from '../unify/JUrlList'; import _ from '../unify/JDataUnify'; /** * 城市及定位接口 * @alias network/JNetworkCity */ class JNetworkCity { /** * 获取城市列表 * @returns {*} */ static cityList() { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cityUrl.jbzCities).then(data =&gt; { resolve(_('cityUrl.jbzCities', data)); }, error =&gt; { reject(error); }); }); } /** * 通过经纬度获取城市 * @param coordinate 位置信息 * @returns {*} */ static cityByCoordinate(coordinate) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cityUrl.jbzCityByCoordinate, coordinate).then(data =&gt; { resolve(_('cityUrl.jbzCityByCoordinate', data)); }, error =&gt; { reject(error); }); }); } /**+ * 通过经纬度获取城市（通过代理传递） * @returns {{terminate, then}|*} */ static cityNeedCoordinate() { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cityUrl.jbzCityByCoordinate, {...JNetwork.locationParas()}).then(data =&gt; { resolve(_('cityUrl.jbzCityByCoordinate', data)); }, error =&gt; { reject(error); }); }); } /** * 通过城市id获取城市 * @param cityId * @returns {{terminate, then}|*} */ static cityById(cityId) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cityUrl.jbzCityById, {cityId}).then(data =&gt; { resolve(_('cityUrl.jbzCityById', data)); }, error =&gt; { reject(error); }); }); } /**+ * 获取地区列表 * @param cityId * @returns {{terminate, then}|*} */ static cityDistrictList(cityId) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cityUrl.jbzDistricts, {cityId}).then(data =&gt; { resolve(_('cityUrl.jbzDistricts', data)); }, error =&gt; { reject(error); }); }) } /** * 获取热门城市列表 * @returns {{terminate, then}|*} */ static cityHotList() { return new Promise((resolve, reject) =&gt; { JNetwork.POST(cityUrl.jbzHotCities).then(data =&gt; { resolve(_('cityUrl.jbzHotCities', data)); }, error =&gt; { reject(error); }); }); } } export default JNetworkCity; × Search results Close "},"src_network_JNetworkConfig.js.html":{"id":"src_network_JNetworkConfig.js.html","title":"Source: src/network/JNetworkConfig.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkConfig.js /** * Created by cuppi on 2017/4/14. */ import NetworkManager from './JNetwork'; import {UseConfig as UrlUseConfig} from '../unify/JUrlList' import {UseConfig as DataUseConfig} from '../unify/JDataUnify' /** * 请求配置类 * @alias network/JNetworkConfig */ class JNetworkConfig { static setConfig(config){ NetworkManager.baseUrl = config.baseUrl; NetworkManager.inType = config.inType; NetworkManager.delegate = config.delegate; if (config.inType){ UrlUseConfig(config.inType); DataUseConfig(config.inType); } else { console.log('Didn\\'t find out the inType value, do you forget the inType at config ?') } } } export default JNetworkConfig; × Search results Close "},"src_network_JNetworkFilm.js.html":{"id":"src_network_JNetworkFilm.js.html","title":"Source: src/network/JNetworkFilm.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkFilm.js /** * Created by cuppi on 2016/11/22. */ 'use strict'; import JNetwork from './JNetwork.js'; import {filmUrl} from '../unify/JUrlList'; import _ from '../unify/JDataUnify'; /** * 影片接口 * @alias network/JNetworkFilm */ class JNetworkFilm { /** * 获取热门电影 * @param page 分页模型 * @returns {Promise} */ static filmHotfilms(page) { if (!page) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzHotFilms).then(data =&gt; { resolve(_('filmUrl.jbzHotFilms', data)); }, error =&gt; { reject(error); }); }) } else { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzHotFilmsPage, {page: page.index, size: page.size}).then(data =&gt; { resolve(_('filmUrl.jbzHotFilmsPage', data)); }, error =&gt; { reject(error); }); }); } } /** * 获取热门电影 * @returns {{terminate, then}|*} */ static filmHotfilmsSimple() { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzHotFilmsSimple).then(data =&gt; { resolve(_('filmUrl.jbzHotFilmsSimple', data)); }, error =&gt; { reject(error); }); }) } /** * 获取待映电影 * @param page 页号 * @returns {Promise} */ static filmWaitfilms(page) { if (!page) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzWaitFilms).then(data =&gt; { resolve(_('filmUrl.jbzWaitFilms', data)); }, error =&gt; { reject(error); }); }) } else { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzWaitFilmsPage, {page: page.index, size: page.size}).then(data =&gt; { resolve(_('filmUrl.jbzWaitFilmsPage', data)); }, error =&gt; { reject(error); }); }); } } /** * 获取影片详情 * @param filmId 影片Id * @param platform 平台类型(默认使用jbz平台) * @returns {Promise} */ static filmDetail(filmId, platform = null) { if (platform &amp;&amp; platform !== 'jbz') { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzFilmDetailByPartner, {platformFilmId: filmId, platform}).then(data =&gt; { resolve(_('filmUrl.jbzFilmDetailByPartner', data)); }, error =&gt; { reject(error); }); }); } else { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzFilmDetail, {filmId}).then(data =&gt; { resolve(_('filmUrl.jbzFilmDetail', data)); }, error =&gt; { reject(error); }); }); } } /** * 获取影片排片日期列表 * @param filmId 影片Id * @param cityId 城市Id * @returns {Promise} */ static filmDateList(filmId, cityId) { return new Promise((resolve, reject) =&gt; { JNetwork.POST(filmUrl.jbzFilmDate, {filmId, cityId}).then(data =&gt; { resolve(_('filmUrl.jbzFilmDate', data)); }, error =&gt; { reject(error); }) }) } static filmDateListNeedCity(filmId) { console.log(JNetwork.locationParas().cityId); return JNetworkFilm.filmDateList(filmId, JNetwork.locationParas().cityId) } } export default JNetworkFilm; × Search results Close "},"src_network_JNetworkMine.js.html":{"id":"src_network_JNetworkMine.js.html","title":"Source: src/network/JNetworkMine.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkMine.js /** * Created by cuppi on 2017/3/6. */ 'use strict'; import JNetwork from './JNetwork.js'; import {mineUrl} from '../unify/JUrlList'; /** * 个人中心接口 * @alias network/JNetworkMine */ class JNetworkMine { /** * 我的订单 * @returns {*} */ static mineOrderNeedLogin() { let loginParas = JNetwork.loginParas(); if (!loginParas.hasAccount) { return JNetwork.failedAuthorizationNetwork(); } let {openId, sessionId} = loginParas; return JNetwork.POST(mineUrl.userorders, { openId }, { openId, sessionId }); } /** * 我的收藏 * @returns {*} */ static mineFavoriteNeedLogin() { let loginParas = JNetwork.loginParas(); if (!loginParas.hasAccount) { return JNetwork.failedAuthorizationNetwork(); } let {openId, sessionId} = loginParas; return JNetwork.POST(mineUrl.collectedcinemalist, { openId: openId }, { openId: openId, sessionId }); } } export default JNetworkMine; × Search results Close "},"src_network_JNetworkOther.js.html":{"id":"src_network_JNetworkOther.js.html","title":"Source: src/network/JNetworkOther.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkOther.js /** * Created by cuppi on 2016/12/1. */ 'use strict'; import JNetwork from './JNetwork.js'; import {otherUrl} from '../unify/JUrlList'; import _ from '../unify/JDataUnify'; /** * 其他接口 * @alias network/JNetworkOther */ class JNetworkOther { /** * 搜索 * @param cityId 城市Id * @param key 关键字 * @param lastKey 下一页的句柄 * @returns {{terminate, then}|*} */ static otherSearch(cityId, key, lastKey) { if (cityId) { // return JNetwork.POST(otherUrl.jbzSearch, { // cityId, // queryStr: key, // lastKey: lastKey // }); } else { return JNetwork.POST(otherUrl.jbzSearch, { queryStr: key, lastKey: lastKey }); } } /** * 热搜词汇 * @returns {{terminate, then}|*} */ static hotQuery() { return JNetwork.POST(otherUrl.hotquery); } /** * 广告接口 * @returns {{terminate, then}|*} */ static otherBanners(location, cityId) { return new Promise((resolve, reject) =&gt; { return JNetwork.POST(otherUrl.jbzBanners, { location, cityId }).then(data =&gt; { resolve(_('otherUrl.jbzBanners', data)); }, error =&gt; { reject(error); }); }) } } export default JNetworkOther; × Search results Close "},"src_network_JNetworkTrade.js.html":{"id":"src_network_JNetworkTrade.js.html","title":"Source: src/network/JNetworkTrade.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkTrade.js /** * Created by cuppi on 2016/12/7. */ 'use strict'; import JNetwork from './JNetwork.js'; import {tradeUrl} from '../unify/JUrlList'; import _ from '../unify/JDataUnify'; /** * 交易接口 * @alias network/JNetworkTrade */ class JNetworkTrade { /** * 锁座 * @param type 平台类型 * @param paras 锁座参数 * @returns {{terminate, then}|*} */ static tradeLockSeatNeedLogin(type, paras) { let loginParas = JNetwork.loginParas(); return new Promise((resolve, reject) =&gt; { JNetwork.POST(tradeUrl.jbzLockSeat, {type, ...paras}).then(data =&gt; { resolve(_('tradeUrl.jbzLockSeat', data)); }, error =&gt; { reject(error); }); }); } /** * 取消锁座 * @param orderId 订单Id * @returns {{terminate, then}|*} */ static cancelLockSeatNeedLogin(orderId) { return JNetwork.POST(tradeUrl.jbzCancelOrder, {orderId}) } /** * 下订单 * @param type 平台类型 * @param paras 下订单参数 * @returns {{terminate, then}|*} */ static tradeApplyOrderNeedLogin(type, paras) { let loginParas = JNetwork.loginParas(); let inType = JNetwork.inType; if (inType === 'ICBC-APP' || inType === 'SHANGHAI-APP') { return new Promise((resolve, reject) =&gt; { JNetwork.POST(tradeUrl.jbzWebAtAppApplyTicket, {type, ...paras}).then(data =&gt; { resolve(_('tradeUrl.jbzWebAtAppApplyTicket', data)); }, error =&gt; { reject(error); }); }); } // if (inType === 'DPIOS' || inType === 'DPANDROID') { // return JNetwork.POST(tradeUrl.jbzAppApplyTicket, {type, ...paras}, loginParas); // } // // if (inType === 'DPWX' || inType === 'DPWEB' || inType === 'PC') { // return JNetwork.POST(tradeUrl.jbzWepApplyTicket, {type, ...paras}, loginParas); // } return JNetwork.wrongInType(); } /** * 申请预订单 * @param orderId 订单Id * @param payType 支付类型 * @param prizeIds 待定 * @param redIds 待定 * @returns {{terminate, then}|*} */ static tradePrePayOrderNeedLoginInType(orderId, payType, prizeIds, redIds) { let loginParas = JNetwork.loginParas(); let inType = JNetwork.inType; if (inType === 'DPIOS' || inType === 'DPANDROID') { return JNetwork.POST(tradeUrl.jbzAppPrepay, {orderId, payType, prizeIds, redIds}, loginParas); } if (inType === 'DPWX' || inType === 'DPWEB' || inType === 'PC') { return JNetwork.POST(tradeUrl.jbzWebPrepay, {orderId, payType, prizeIds, redIds}, loginParas); } return JNetwork.wrongInType(); } } export default JNetworkTrade; × Search results Close "},"src_network_JNetworkFunc.js.html":{"id":"src_network_JNetworkFunc.js.html","title":"Source: src/network/JNetworkFunc.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/network/JNetworkFunc.js /** * Created by cuppi on 2017/5/9. */ /** * @private */ class Jpara { constructor(...paras) { this._paras = []; for (let para of paras) { this._paras.push(para); } this.isJpara = true; } items() { return this._paras; } static emptyPara() { return new Jpara(); } } /** * 辅助任务类 * @private */ class Jtask { constructor(task, parasPicker, resolve, reject) { this._task = task; this._resolve = resolve; this._reject = reject; this._parasPicker = parasPicker; } setNextTask(task) { this._nextTask = task; } do(paras) { paras = paras ? paras : this._parasPicker(); this._task(...this.paraItems(paras)).then(data =&gt; { let nextPara = this._resolve(data, ...this.paraItems(paras)); if (this._nextTask) { this._nextTask.do(nextPara); } }, error =&gt; { if (this._reject){ this._reject(error, ...this.paraItems(paras)) } else { console.log('ERROR: Don\\'t find the error handler for task (' + this._task.name + ')'); } }); } paraItems(nextPara) { if (nextPara &amp;&amp; nextPara.isJpara) { return nextPara.items(); } return Jpara.emptyPara().items(); } } /** * * 任务连接类 * @private */ class Jlink { constructor(...tasks) { this._tasks = []; for (var task of tasks) { this._tasks.push(task); } this._taskIndex = 0; } para(para) { this._headTaskPara = para; return this; } paras(...paras) { this._allTaskPara = paras; return this; } next(resolve, reject) { if (this._taskIndex &gt;= this._tasks.length) { return this; } let nextTask = new Jtask(this._tasks[this._taskIndex], this._parasPicker(this._taskIndex), resolve, reject); this._taskIndex++; if (this._nextTask) { this._nextTask.setNextTask(nextTask); } else { this._headTask = nextTask; } this._nextTask = nextTask; return this; } run() { this._headTask.do(this._parasPicker(0)()); return this; } /** * 指定任务的paras的获取者 (目前实现会浪费内存，多个相同函数推入函数栈，后期优化） * @returns {Array} * @private */ _parasPicker(index) { return () =&gt; { if (this._allTaskPara &amp;&amp; this._allTaskPara.length &gt; index) { return this._allTaskPara[index]; } if (index === 0 &amp;&amp; this._headTaskPara) { return this._headTaskPara; } return Jpara.emptyPara(); } } } /** * 任务组合类 * @private */ class Jcombine { constructor(...tasks) { this._tasks = []; for (var task of tasks) { this._tasks.push(task); } this._taskIndex = 0; } para(para) { this._headTaskPara = para; return this; } paras(...paras) { this._allTaskPara = paras; return this; } next(resolve, reject) { if (this._taskIndex &gt;= this._tasks.length) { return this; } let nextTask = new Jtask(this._tasks[this._taskIndex], this._parasPicker(this._taskIndex), resolve, reject); this._taskIndex++; if (this._nextTask) { this._nextTask.setNextTask(nextTask); } else { this._headTask = nextTask; } this._nextTask = nextTask; return this; } run() { this._headTask.do(this._parasPicker(0)()); return this; } } /** * 任务连接类 * @alias other/jlink * @param tasks * @returns {Jlink} */ function jlink(...tasks) { return new Jlink(...tasks); } /** * @private * @param paras * @returns {Jpara} */ function jpara(...paras) { return new Jpara(...paras); } /** * @alias other/jcombine * @param tasks * @returns {Jcombine} */ function jcombine(...tasks) { return new Jcombine(...tasks); } export {jlink, jpara}; × Search results Close "},"src_tool_JToolArray.js.html":{"id":"src_tool_JToolArray.js.html","title":"Source: src/tool/JToolArray.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/tool/JToolArray.js /** * Created by cuppi on 2016/12/7. */ /** * 数组工具类 * @alias tool/JToolArray */ class ArrayTool { } export default ArrayTool; × Search results Close "},"src_tool_JToolDate.js.html":{"id":"src_tool_JToolDate.js.html","title":"Source: src/tool/JToolDate.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/tool/JToolDate.js /** * Created by cuppi on 2016/11/25. */ import NumberTool from './JToolNumber.js'; /** * 时间工具类 * @alias tool/JToolDate */ class DateTool { /** * 日期字符串转换时间戳 * 注：时间格式需满足Date规范 * 如 2017-05-23 18:56:00、2017/05/23 * @param dateString 日期 * @returns {number} */ static timeIntervalFromDateString(dateString) { return DateTool.timeIntervalFromDate(new Date(dateString)); } /** * 日期转换时间戳 * @static * @param date 日期 * @returns {number} */ static timeIntervalFromDate(date) { return Date.parse(date) / 1000; } /** * 时间戳转换日期字符串 * @param timeInterval 时间戳 * @param format 日期格式 如: yyyy-MM-dd hh:mm:ss * @returns {*} */ static dateStringFromTimeInterval(timeInterval, format) { if (format) { return DateTool.dateStringFromDate(new Date(timeInterval * 1000), format); } else { return DateTool.dateStringFromDate(new Date(timeInterval * 1000), 'yyyy-MM-dd hh:mm:ss'); } } /** * 时间戳转换日期 * @param timeInterval 时间戳 * @returns {Date} 日期 */ static dateFromTimeInterval(timeInterval) { return new Date(timeInterval * 1000); } // TODO 需要优化月份的算法 /** * 时间戳的距离 * @param startTimeInterval 起始时间戳 * @param endTimeInterval 结束时间戳 * @param justSeconds 只需要秒的总数 * @returns {Array} [秒，分，小时，天，月, 年] */ static distanceBetweenTimeInterval(startTimeInterval, endTimeInterval, justSeconds) { let distance = endTimeInterval - startTimeInterval; if (justSeconds) { return [distance, 0, 0, 0, 0]; } let sec = distance % 60; distance = parseInt(distance / 60); let min = distance % 60; distance = parseInt(distance / 60); let hour = distance % 24; distance = parseInt(distance / 24); let day = distance % 30; let mou = parseInt(distance / 30); return [sec, min, hour, day, mou]; } /** * 时间戳的距离 * @param startDate 起始日期 * @param endDate 结束日期 * @param justSeconds 只需要秒的总数 * @returns {Array} [秒，分，小时，天，月, 年] */ static distanceBetweenDate(startDate, endDate, justSeconds) { return DateTool.distanceBetweenTimeInterval(DateTool.timeIntervalFromDate(startDate), DateTool.timeIntervalFromDate(endDate), justSeconds) } /** * 时间戳的距离 * @param startDateString 起始日期字符串 * @param endDateString 结束日期字符串 * @param justSeconds 只需要秒的总数 * @returns {Array} [秒，分，小时，天，月, 年] */ static distanceBetweenDateString(startDateString, endDateString, justSeconds) { return DateTool.distanceBetweenTimeInterval(DateTool.timeIntervalFromDateString(startDateString), DateTool.timeIntervalFromDateString(endDateString), justSeconds) } /** * 获取日期的指定格式的字符串 * @param date Date对象 * @param format 格式化信息 */ static dateStringFromDate(date, format) { let paddNum = function (num) { num += ''; return num.replace(/^(\\d)$/, '0$1'); }; // 指定格式字符 let cfg = { yyyy: date.getFullYear(), // 年 : 4位 yy: date.getFullYear().toString().substring(2), // 年 : 2位 M: date.getMonth() + 1, // 月 : 如果1位的时候不补0 MM: paddNum(date.getMonth() + 1), // 月 : 如果1位的时候补0 d: date.getDate(), // 日 : 如果1位的时候不补0 dd: paddNum(date.getDate()), // 日 : 如果1位的时候补0 hh: date.getHours(), // 时 mm: paddNum(date.getMinutes()), // 分 ss: paddNum(date.getSeconds()) // 秒 }; format || (format = 'yyyy-MM-dd hh:mm:ss'); return format.replace(/([a-z])(\\1)*/ig, function (m) { return cfg[m]; }); } // TODO 待开发 /** * 获取字符串的指定格式的日期 （待开发） * @param dateString 日期字符串 * @param format 日期格式 * @returns {Date} */ static dateFromDateString(dateString, format) { return new Date(dateString); } /** * 获取当前日期对象 * @returns {Date} */ static currentDate() { return new Date(); } /** * 获取当前日期字符串 * @returns {Date} */ static currentDateString(format) { if (format) { return DateTool.dateFromTimeInterval(DateTool.currentTimeInterval(), format); } return DateTool.dateFromTimeInterval(DateTool.currentTimeInterval()); } /** * 获取当前时间戳 * @returns {number} */ static currentTimeInterval() { return parseInt(Date.now() / 1000); } // TODO 待开发 /** * 变换日期字符串格式 （待开发） * @param dateString 日期字符串 * @param fromFormat 输入格式 * @param toFormat 输出格式 * @returns {*} */ static transformDateStringByFormat(dateString, fromFormat, toFormat) { let timeInterval = DateTool.timeIntervalFromDateString(dateString, fromFormat); return DateTool.dateStringFromTimeInterval(timeInterval, toFormat); } /** * 获取指定日期为星期几 * @param date 日期对象 * @returns {number} 0~6 星期一~星期日 */ static weekDayFromDate(date) { return date.getDay(); } /** * 获取指定日期字符串为星期几 * @param dateString 标准日期字符串 * @param format 日期格式 * @returns {number} 0~6 星期一~星期日 */ static weekDayFromDateString(dateString) { return DateTool.weekDayFromDate(DateTool.dateFromDateString(dateString, format)); } /** * 指定日期的某天后 * @param beganDate * @param days * @returns {string} */ static dateSeveralDaysLater(beganDate, days) { let endDate = new Date(); endDate.setDate(beganDate.getDate() + days); let y = endDate.getFullYear(); let m; let d; if (endDate.getMonth() &gt; 8) { m = endDate.getMonth() + 1; } else { m = '0' + (endDate.getMonth() + 1); } if (endDate.getDate() &gt; 9) { d = endDate.getDate(); } else { d = '0' + endDate.getDate(); } return y + '-' + m + '-' + d; } /** * 指定日期字符串的某天后 * @param beganDateString 标准日期字符串 * @param days 天数 * @param format 日期格式化 * @returns {string} */ static dateStringSeveralDaysLater(beganDateString, days) { let beganDate = DateTool.dateFromDateString(beganDateString); let endDate = new Date(beganDate); endDate.setDate(beganDate.getDate() + days); let y = endDate.getFullYear(); let m; let d; if (endDate.getMonth() &gt; 8) { m = endDate.getMonth() + 1; } else { m = '0' + (endDate.getMonth() + 1); } if (endDate.getDate() &gt; 9) { d = endDate.getDate(); } else { d = '0' + endDate.getDate(); } return y + '-' + m + '-' + d; } } export default DateTool; × Search results Close "},"src_tool_JToolNumber.js.html":{"id":"src_tool_JToolNumber.js.html","title":"Source: src/tool/JToolNumber.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/tool/JToolNumber.js 'use strict'; import leftPad from 'left-pad'; /** * 数字工具类 * @alias tool/JToolNumber */ class NumberTool { /** * 整数补0 * @param number 整数 * @param length 最终的长度 * @returns {*|Blob|string|ArrayBuffer|Array.&lt;T&gt;} 整数字符串 */ static zeroPad(number, length) { return leftPad(number, length); } /** * 小数部分有效数字保留 * @param number 数字 * @param digits 小数保留位数 * @returns {string} 数字的字符串 */ static fixDigits(number, digits) { return Number(number).toFixed(digits); } /** * 返回正整数的字符串（非正整数返回指定字符串或空字符串） * @param number 数字 * @param text 非正整数的返回（可空） * @returns {*} */ static positiveText(number, text) { if (number &lt;= 0) { return text ? text : ''; } else { return number + ''; } } } export default NumberTool; × Search results Close "},"src_tool_JToolObject.js.html":{"id":"src_tool_JToolObject.js.html","title":"Source: src/tool/JToolObject.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/tool/JToolObject.js /** * Created by cuppi on 2017/5/10. */ /** * 对象工具类 * @alias tool/JToolObject */ class ObjectTool{ /** * 删除对象某个属性 * @param target 对象 * @param propertyKey 属性 * @returns {boolean} */ static deleteProperty(target, propertyKey){ if (target){ return Reflect.deleteProperty(target, propertyKey); } return true; } } export default ObjectTool; × Search results Close "},"src_tool_JToolString.js.html":{"id":"src_tool_JToolString.js.html","title":"Source: src/tool/JToolString.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/tool/JToolString.js 'use strict'; /** * 字符串工具类 * @alias tool/JToolString */ class StringTool { /** * 校验是否为手机号码 * @param mobile 手机号码 * @returns {boolean} */ static isMobile(mobile) { return (/^1[34578]\\d{9}$/.test(mobile)); } /** * 校验是否为电话号码 * @param phone * @returns {boolean} */ static isPhoneNumber(phone) { return /(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}/.test(phone); } /** * 检验是否为邮箱 * @param email */ static isEmail(email) { return /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\\.[a-zA-Z0-9_-]{2,3}){1,2})$/.test(email); } /** * 校验是否为空字符串 * @param string * @returns {boolean} */ static isEmpty(string) { return !(string &amp;&amp; string !== ''); } /** * 校验是否为验证码（即0~9 6位数字） * @param verifycode * @returns {boolean} */ static isVerifyCode(verifycode) { return (/^[0-9]{6}$/.test(verifycode)); } /** * 校验是否为密码 * @param password 密码 * @param minLength 最小长度 * @param maxLength 最大长度 * @returns {boolean} */ static isPassword(password, minLength, maxLength) { if (minLength !== undefined &amp;&amp; maxLength !== undefined) { return new RegExp(&quot;^[a-zA-Z0-9]{&quot; + minLength + &quot;,&quot; + maxLength + &quot;}$&quot;).test(password); } return (/^[a-zA-Z0-9]{6,14}$/.test(password)); } /** * 通过asc得出字符数值 * @param ascChar * @returns {Number} */ static numberFromASC(ascChar) { let asc = ascChar.charCodeAt(0); if (asc &gt;= 65 &amp;&amp; asc &lt;= 90) { asc -= 65; } else if (asc &gt;= 97 &amp;&amp; asc &lt;= 122) { asc -= 97; } else if (asc &gt;= 48 &amp;&amp; asc &lt;= 57) { asc -= 48; } else { asc = 0; } return asc; } /** * 转换字符串到数字 * @param string 字符串 * @param force 是否强制转换非数字字符 (即为26进制数字) * @returns {number} */ static numberFromString(string, force) { if (/^[0-9]*$/.test(string)) { return Number.parseInt(string); } let sum = 0; if (force) { for (let i = string.length - 1, radix = 1; i &gt;= 0; i--, radix = radix * 26) { sum += StringTool.numberFromASC(string[i]) * radix; } } return sum; } /** * 清除所有空格字符 * @param string 字符串 */ static clearSpace(string) { // 过滤空格 let unSpaceString = string.replace(/\\s+/g, ''); return unSpaceString; } /** * 清除所有逗号 * @param string 字符串 */ static clearComma(string) { // 过滤空格 let unCommaString = string.replace(/\\u002c+/g, '').replace(/，+/g, ''); return unCommaString; } /** * 清除所有竖线 * @param string 字符串 */ static clearVertical(string) { // 过滤空格 let unVerticalString = string.replace(/\\|+/g, ''); return unVerticalString; } /** * 清除所有特殊字符 * @param string 字符串 * @returns {*} */ static clearClutter(string) { let clearString = StringTool.clearSpace(string); clearString = StringTool.clearComma(clearString); clearString = StringTool.clearVertical(clearString); return clearString; } } export default StringTool; × Search results Close "},"src_tool_JToolUrl.js.html":{"id":"src_tool_JToolUrl.js.html","title":"Source: src/tool/JToolUrl.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/tool/JToolUrl.js /** * Created by cuppi on 2016/12/14. */ /** * 网络地址工具类 * @alias tool/JToolUrl */ class UrlTool { /** * 合成URL完整地址 * @param baseUrl 基础地址 * @param subUrl 相对地址 * @param parameters 参数 * @returns {*} 返回拼接后的地址 */ static urlFromPortion(baseUrl, subUrl, parameters) { if (!parameters) { parameters = {}; } let paras = []; for (let key in parameters) { if (!parameters.hasOwnProperty(key)) { continue; } if (parameters[key] !== undefined) { paras.push(key + '=' + parameters[key]); } } let iUrl = baseUrl + subUrl; if (paras.length &gt; 0) { iUrl = iUrl + '?' + paras.join('&amp;'); } return iUrl; } /*********** 待完善接口 **************/ /** * * @param name * @returns {*} */ // static getUrlQuery(name) { // let reg = new RegExp(`(^|&amp;)${name}=([^&amp;]*)(&amp;|$)`); // let result = window.location.search.substr(1).match(reg); // let inType = result ? decodeURIComponent(result[2]) : null; // return inType; // } // static getNowUrl() { // let nowUrl = window.location.href; // nowUrl = nowUrl.substring(0, nowUrl.indexOf('#/')); // return nowUrl // } } export default UrlTool; × Search results Close "},"src_util_JManagerSeat.js.html":{"id":"src_util_JManagerSeat.js.html","title":"Source: src/util/JManagerSeat.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/util/JManagerSeat.js /** * Created by cuppi on 2016/12/5. */ import NetworkCinemaManager from '../network/JNetworkCinema.js'; import StringTool from '../tool/JToolString.js'; import AutoSeatPicking from '../arithmetic/AutoSeatPicking'; const _cellSize = 30; const _cellSpace = 8; let instance = null; /** * 座位图管理类 * @alias util/JManagerSeat */ class SeatManager { /** * 构造器 * @returns {*} */ constructor() { if (!instance) { instance = this; } return instance; } /** * 单例方法 * @returns {SeatManager} */ static defaultManager() { return new SeatManager(); } /** * 智能选座 * @param smartSeats * @param count * @returns {Promise} */ static smartAutoSelected(smartSeats, count) { return new Promise((reduce, reject) =&gt; { AutoSeatPicking.defaultManager().autoSelected(smartSeats, count, (data) =&gt; { reduce(data); }); }); } /** * 获取座位图时需要的参数 * @param platform 平台类型 * @param screening 平台数据 * @returns {Object} 平台需要的参数 */ static seatParasFromScreening(platform, screening) { var paras = {}; if (platform === 'wangpiao') { paras = { cinemaId: screening.cinemaId, showId: screening.showId } } if (platform === 'spider') { paras = { cinemaId: screening.cinemaId, showId: screening.showId, hallId: screening.hallId } } if (platform === 'maizuo') { paras = { showId: screening.showId } } if (platform === 'danche') { paras = { showId: screening.showId } } if (platform === 'maoyan' || platform === 'meituan' || platform === 'dazhong') { paras = { showId: screening.showId } } if (platform === 'baidu') { paras = { showId: screening.showId } } return paras; } /** * 对原始座位图进行智能转换 * @param type 平台类型 * @param seatData 座位图原始数据 * @returns {Array} 智能座位图列表 */ smartSeatsFromSeats(type, seatData){ let seatList = this.unitySeatWithSeatData(type, seatData); // 获取智能座位图 return this.smartSeatsWithSeats(type, seatList); } /** * 获取智能座位图元数据 * @param type 平台类型 * @param smartSeats 智能座位图 * @returns {{smartSeats: Array, seatRowData: Array.&lt;*&gt;}} 智能座位图详细信息 */ smartSeatDataFromSmartSeats(type, smartSeats) { let seatRowData = this.rowDataFromSmartSeats(smartSeats); let seatContentData = this.seatContentDataFromSmartSeats(smartSeats); return {smartSeats, seatRowData, ...seatContentData}; } /** * 对原始座位图进行智能转换 * @param type 平台类型 * @param seatData 座位图原始数据 * @returns {{smartSeats: Array, seatRowData: Array.&lt;*&gt;}} 智能座位图详细信息 */ smartSeatDataFromSeats(type, seatData) { // 获取智能座位图 let smartSeats = this.smartSeatsFromSeats(type, seatData); return this.smartSeatDataFromSmartSeats(type, smartSeats); } /** *********************** 下面的方法为内部方法 ******************** **/ /** * 统一座位格式 * @private * @param type * @param seatData * @returns {Array} */ unitySeatWithSeatData(type, seatData) { if (type === 'maoyan' || type === 'meituan' || type === 'dazhong') { let seatList = []; let sections = seatData.sections; for (let section of sections) { for (let sectionId in section) { if (section.hasOwnProperty(sectionId)) { let seatMap = section[sectionId].seatMap; let maxRow = section[sectionId].maxRow ? section[sectionId].maxRow : 0; let maxColumn = section[sectionId].maxColumn ? section[sectionId].maxColumn : 0; for (let i = 0; i &lt;= maxRow; i++) { for (let j = 0; j &lt;= maxColumn; j++) { let seat = seatMap[i + ':' + j]; // 去掉走廊 if (seat &amp;&amp; seat.status !== 'E') { seat.sectionId = sectionId; // 时间复杂度多了 但是代码整洁 seatList.push(seat); } } } } } } return seatList; } let seatList = []; let seatMap = seatData.seatMap; let maxRow = seatData.maxRow; let maxColumn = seatData.maxColumn; // 获取基本座位图 if (type === 'danche') { for (let i = 0; i &lt;= maxRow; i++) { for (let j = 0; j &lt;= maxColumn; j++) { let seat = seatMap[i + ':' + j]; if (seat &amp;&amp; seat.isSeat) { // 时间复杂度多了 但是代码整洁 seatList.push(seat); } } } } else if (type === 'baidu') { for (let i = 0; i &lt;= maxRow; i++) { for (let j = 0; j &lt;= maxColumn; j++) { let seat = seatMap[i + ':' + j]; if (seat &amp;&amp; seat.seatNo &amp;&amp; seat.seatNo !== '') { seat.rowId = i; seat.columnId = j; // 时间复杂度多了 但是代码整洁 seatList.push(seat); } } } } else { for (let i = 0; i &lt;= maxRow; i++) { for (let j = 0; j &lt;= maxColumn; j++) { let seat = seatMap[i + ':' + j]; if (seat) { // 时间复杂度多了 但是代码整洁 seatList.push(seat); } } } } return seatList; } /** * 获取智能座位图通用方法 * @private * @param type 平台类型 * @param seatList 基本座位图 * @returns {Array} 智能座位图 */ smartSeatsWithSeats(type, seatList) { if (type === 'wangpiao') { return this.smartSeatsWithWPSeats(seatList); } if (type === 'spider') { return this.smartSeatsWithSPSeats(seatList); } if (type === 'maizuo') { return this.smartSeatsWithMZSeats(seatList); } if (type === 'danche') { return this.smartSeatsWithDCSeats(seatList); } if (type === 'maoyan' || type === 'meituan' || type === 'dazhong') { return this.smartSeatsWithMYSeats(seatList); } if (type === 'baidu') { return this.smartSeatsWithBDSeats(seatList); } } /** * 获取网票智能座位图 * @private * @param seatList * @returns {Array} */ smartSeatsWithWPSeats(seatList) { return seatList.map((seatModel) =&gt; { let row = Number.parseInt(seatModel.key.split(':').shift()); let col = Number.parseInt(seatModel.key.split(':').pop()); let rowNumber = StringTool.numberFromString(seatModel.Name.split(':').shift()); let colNumber = StringTool.numberFromString(seatModel.Name.split(':').pop()); return { row: row, col: col, rowNumber: rowNumber, colNumber: colNumber, seatModel: seatModel }; }).map((bridgeModel) =&gt; { let seatRowModel = bridgeModel.seatModel; return { ...bridgeModel, // N:lock Y:unLock status: seatRowModel.Status === 'Y' ? 0 : 1, rowLocation: bridgeModel.row * (_cellSize + _cellSpace), colLocation: bridgeModel.col * (_cellSize + _cellSpace), loveIndex: Number.parseInt(seatRowModel.LoveFlag) }; }); } /** * 获取蜘蛛智能座位图 * @private * @param seatList * @returns {Array} */ smartSeatsWithSPSeats(seatList) { return seatList.map((seatModel) =&gt; { let row = Number.parseInt(seatModel.rowNum); let col = Number.parseInt(seatModel.columnNum); let rowNumber = Number.parseInt(StringTool.numberFromString(seatModel.rowId)); let colNumber = Number.parseInt(StringTool.numberFromString(seatModel.columnId)); return { row: row, col: col, rowNumber: rowNumber, colNumber: colNumber, seatModel: seatModel }; }).map(bridgeModel =&gt; { let seatRowModel = bridgeModel.seatModel; return { ...bridgeModel, status: seatRowModel.isLock ? 1 : 0, rowLocation: bridgeModel.row * (_cellSize + _cellSpace), colLocation: bridgeModel.col * (_cellSize + _cellSpace), loveIndex: Number.parseInt(seatRowModel.loveIndex) } }); } /** * 获取卖座智能座位图 * @private * @param seatList * @returns {Array} */ smartSeatsWithMZSeats(seatList) { return seatList.map((seatModel) =&gt; { let row = Number.parseInt(seatModel.rowNum); let col = Number.parseInt(seatModel.columnNum); let rowNumber = Number.parseInt(StringTool.numberFromString(seatModel.rowId)); let colNumber = Number.parseInt(StringTool.numberFromString(seatModel.columnId)); // 上海百美汇影城 return { row: row, col: col, rowNumber: rowNumber, colNumber: colNumber, seatModel: seatModel }; }).map(bridgeModel =&gt; { let seatRowModel = bridgeModel.seatModel; return { ...bridgeModel, status: seatRowModel.isLock === '1' ? 1 : 0, rowLocation: bridgeModel.row * (_cellSize + _cellSpace), colLocation: bridgeModel.col * (_cellSize + _cellSpace), loveIndex: Number.parseInt(seatRowModel.loveIndex) } }); } /** * 获取单车智能座位图 * @private * @param seatList * @returns {Array} */ smartSeatsWithDCSeats(seatList) { return seatList.map((seatModel) =&gt; { let row = Number.parseInt(seatModel.rowNum); let col = Number.parseInt(seatModel.columnNum); let rowNumber = Number.parseInt(StringTool.numberFromString(seatModel.rowId)); let colNumber = Number.parseInt(StringTool.numberFromString(seatModel.columnId)); return { row: row, col: col, rowNumber: rowNumber, colNumber: colNumber, seatModel: seatModel }; }).map(bridgeModel =&gt; { let seatRowModel = bridgeModel.seatModel; console.log(seatRowModel.loveIndex); return { ...bridgeModel, status: seatRowModel.isLock ? 1 : 0, rowLocation: bridgeModel.row * (_cellSize + _cellSpace), colLocation: bridgeModel.col * (_cellSize + _cellSpace), loveIndex: Number.parseInt(seatRowModel.loveIndex) } }); } /** * 获取猫眼智能座位图 * @private * @param seatList * @returns {Array} */ smartSeatsWithMYSeats(seatList) { return seatList.map((seatModel) =&gt; { let row = Number.parseInt(seatModel.rowNo); let col = Number.parseInt(seatModel.columnNo); let rowNumber = Number.parseInt(StringTool.numberFromString(seatModel.rowId)); let colNumber = Number.parseInt(StringTool.numberFromString(seatModel.columnId)); return { row: row, col: col, rowNumber: rowNumber, colNumber: colNumber, seatModel: seatModel }; }).map(bridgeModel =&gt; { var seatRowModel = bridgeModel.seatModel; let loveIndex = 0; if (seatRowModel.status === 'L') { loveIndex = 1; } else if (seatRowModel.status === 'R') { loveIndex = 2; } return { ...bridgeModel, status: seatRowModel.status === 'LK' ? 1 : 0, rowLocation: bridgeModel.row * (_cellSize + _cellSpace), colLocation: bridgeModel.col * (_cellSize + _cellSpace), loveIndex: loveIndex } }); } /** * 获取百度智能座位图 * @private * @param seatList * @returns {Array} */ smartSeatsWithBDSeats(seatList) { return seatList.map((seatModel) =&gt; { let row = Number.parseInt(seatModel.rowId); let col = Number.parseInt(seatModel.columnId); let rowNumber = Number.parseInt(StringTool.numberFromString(seatModel.rowNo)); let colNumber = Number.parseInt(StringTool.numberFromString(seatModel.columnNo)); return { row: row, col: col, rowNumber: rowNumber, colNumber: colNumber, seatModel: seatModel }; }).map((bridgeModel) =&gt; { let seatRowModel = bridgeModel.seatModel; return { ...bridgeModel, status: seatRowModel.status === '2' ? 1 : 0, rowLocation: bridgeModel.row * (_cellSize + _cellSpace), colLocation: bridgeModel.col * (_cellSize + _cellSpace), loveIndex: Number.parseInt(seatRowModel.isLove), areaInfo: seatRowModel.area }; }); } /** * 获取座位图尺寸 * @private * @param smartSeats 智能座位图 * @returns {{width: *, height: *}} 座位图尺寸 */ seatContentSizeWithSmartSeats(smartSeats) { // 计算座位图大小 let maxWidth = 0; let maxHeight = 0; for (let smartSeatModel of smartSeats) { if (maxWidth &lt; smartSeatModel.colLocation) { maxWidth = smartSeatModel.colLocation; } if (maxHeight &lt; smartSeatModel.rowLocation) { maxHeight = smartSeatModel.rowLocation; } } let seatContentWidth = maxWidth + _cellSize; let seatContentHeight = maxHeight + _cellSize; return {'width': seatContentWidth, 'height': seatContentHeight}; } /** * 获取座位图元数据 * @private * @param smartSeats 智能座位图 * @returns {{seatCellWidth: number, seatCellHeight: number, seatContentWidth, seatContentHeight}} */ seatContentDataFromSmartSeats(smartSeats) { let seatContentSize = this.seatContentSizeWithSmartSeats(smartSeats); return { 'seatCellSpace': _cellSpace, 'seatCellWidth': _cellSize, 'seatCellHeight': _cellSize, 'seatContentWidth': seatContentSize.width, 'seatContentHeight': seatContentSize.height }; } /** * 获取行号数据 * @private * @param smartSeats 智能座位图 * @returns {Array.&lt;*&gt;} 返回行号数据 {rowNumber, colLocation} */ rowDataFromSmartSeats(smartSeats) { let dict = new Map(); for (let seat of smartSeats) { let row = seat.rowNumber; if (dict.hasOwnProperty(row)) { continue; } dict.set(row, seat.rowLocation); } let allRowNumber = dict.keys(); let allRowData = []; for (let rowNumber of allRowNumber) { allRowData.push({rowNumber: rowNumber, colLocation: dict.get(rowNumber)}); } return allRowData.sort((a, b) =&gt; { return a.rowNumber.toString().localeCompare(b.rowNumber.toString()); }) } } export default SeatManager; × Search results Close "},"src_util_JManagerTrade.js.html":{"id":"src_util_JManagerTrade.js.html","title":"Source: src/util/JManagerTrade.js","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Source: src/util/JManagerTrade.js /** * Created by cuppi on 2016/12/7. */ 'use strict' import NetworkTrade from '../network/JNetworkTrade.js'; let instance = null; /** * 交易管理类 * @alias util/TradeManager */ class TradeManager { constructor() { if (!instance) { instance = this; } return instance; } /** * 获取单例实例 * @returns {TradeManager} */ static defaultManager() { return new TradeManager(); } /** * 获取交易商务参数（与座位无关的） * @param platform 平台类型 * @param platformData 平台数据 * @param filmId 电影Id * @param filmName 电影名称 * @param cinemaId 影院Id * @param cinemaName 影院名称 * @returns {*} 商务参数 */ static tradeParasFromPlatform(platform, platformData, filmId, filmName, cinemaId, cinemaName) { if (platform === 'wangpiao') { return { jbzFilmId: filmId, filmId: platformData.filmId, showId: platformData.showIndex, cinemaName: cinemaName, platformCinemaId: platformData.cinemaId, cinemaId }; } if (platform === 'spider') { return { jbzFilmId: filmId, filmId: platformData.filmId, showId: platformData.showId, platformCinemaId: platformData.cinemaId, cinemaId } } if (platform === 'maizuo') { return { jbzFilmId: filmId, filmId: platformData.filmId, showId: platformData.foretellId, filmName: filmName, cinemaName: cinemaName, platformCinemaId: platformData.cinemaId, cinemaId }; } if (platform === 'danche') { return { jbzFilmId: filmId, filmId: platformData.filmId, showId: platformData.id, platformCinemaId: platformData.cinemaId, cinemaId }; } if (platform === 'maoyan' || platform === 'meituan' || platform === 'dazhong') { return { jbzFilmId: filmId, filmId: platformData.filmId, showId: platformData.showId, cinemaName: cinemaName, platformCinemaId: platformData.cinemaId, cinemaId }; } if (platform === 'baidu') { return { showId: platformData.seqid, platformCinemaId: platformData.cinemaId, cinemaId }; } } /** * 获取锁座处理者 * @param type 平台类型 * @param paras 参数 * @returns {*} 返回请求promise */ lockSeatHandlerFrom(type, paras) { return NetworkTrade.tradeLockSeatNeedLogin(type, paras); } /** * 获取下订单处理者 * @param type 平台类型 * @param paras 参数 * @returns {{terminate, then}|*} 返回请求promise */ confirmOrderHandlerFrom(type, paras) { return NetworkTrade.tradeConfirmOrderNeedLogin(type, paras); } /** * 获取锁座时需要的座位参数 * @param type 平台类型 * @param seatList 座位列表（需要购买的） * @param mobile 手机号码 * @param openId 身份标识符（目前跟手机号码一样） * @returns {*} 返回参数对象 */ seatInforParas(type, seatList, mobile) { // 网票 if (type === 'wangpiao') { let seatInfos = []; let seatNumberInfos = []; for (let seat of seatList) { seatInfos.push(seat.seatModel.SeatIndex); seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber); } return { seatIds: seatInfos.join('|'), count: seatInfos.length, seatNumberInfos: seatNumberInfos.join('|'), mobile, openId } } // 蜘蛛 if (type === 'spider') { let seatInfos = []; let seatNumberInfos = []; for (let seat of seatList) { seatInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId); seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber); } return { seatIds: seatInfos.join('|'), count: seatInfos.length, seatNumberInfos: seatNumberInfos.join('|'), mobile, openId } } // 卖座 if (type === 'maizuo') { let seatInfos = []; let seatNumberInfos = []; for (let seat of seatList) { seatInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId); seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber); } return { seatIds: seatInfos.join('|'), count: seatInfos.length, seatNumberInfos: seatNumberInfos.join('|'), mobile, openId } } // 单车 if (type === 'danche') { let seatInfos = []; let seatNumberInfos = []; for (let seat of seatList) { seatInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId); seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber); } return { seatIds: seatInfos.join('|'), count: seatInfos.length, seatNumberInfos: seatNumberInfos.join('|'), mobile, openId } } // 猫眼 if (type === 'maoyan' || type === 'meituan' || type === 'dazhong') { let seatInfos = []; let seatNumberInfos = []; for (let seat of seatList) { if (!seat.seatModel || true) { console.log(seat); } console.log(seat.seatModel); seatInfos.push({ sectionId: seat.seatModel.sectionId, columnId: seat.seatModel.columnId, rowId: seat.seatModel.rowId, seatNo: seat.seatModel.seatNo }); seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber); } return { seatIds: JSON.stringify({ count: seatList.length, list: seatInfos }), seatNumberInfos: seatNumberInfos.join('|'), mobile, openId } } // 百度 if (type === 'baidu') { let seatIds = []; let seatNumberInfos = []; for (let seat of seatList) { seatIds.push(seat.seatModel.seatNo); seatNumberInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId); } return { count: seatIds.length, // 后台设置特意反过来的 seatIds: seatNumberInfos.join('|'), seatNumberInfos: seatIds.join('|'), mobile, openId } } } /** * 购票（执行锁座 下订单 的事务） * @param type 平台类型 * @param tradeParas 商务参数（与座位无关的参数集合） * @param seatList 座位列表 * @param mobile 手机号码 * @param openId 身份标识符（同上） * @returns {*} 返回请求promise */ buyTicket(type, tradeParas, seatList, mobile) { let paras = {...tradeParas, ...this.seatInforParas(type, seatList, mobile)}; let bridgeSelf = this; return { next: function (lockSeatCallback) { return { next: function (confirmOrderCallback) { bridgeSelf.lockSeatHandlerFrom(type, {...paras, cinemaId: paras.platformCinemaId}).then(data =&gt; { lockSeatCallback(null, data); let orderId = data.orderId; let {cinemaId, jbzFilmId, filmId, showId} = paras; let cityId = store.getState().location.locationCity.id; let cityName = store.getState().location.locationCity.name; bridgeSelf.confirmOrderHandlerFrom(type, { orderId, cinemaId, jbzFilmId, filmId, showId, cityId, cityName }).then(data =&gt; { confirmOrderCallback(null, data); }, error =&gt; { confirmOrderCallback(error, null); }); }, error =&gt; { lockSeatCallback(error, null); }); } } } } } /** * 锁座 * @param type 平台类型 * @param tradeParas 商务参数（与座位无关的参数集合） * @param seatList 座位列表 * @param mobile 手机号码 * @returns {Promise} 返回请求promise */ lockSeat(type, tradeParas, seatList, mobile) { let paras = {...tradeParas, ...this.seatInforParas(type, seatList, mobile)}; return new Promise((resolve, reject) =&gt; { this.lockSeatHandlerFrom(type, {...paras, cinemaId: paras.platformCinemaId}).then(data =&gt; { let orderId = data.orderId; let amount = data.originalAmount; let {cinemaId, jbzFilmId, filmId, showId} = paras; // 下面两个 let cityId = store.getState().location.locationCity.id; let cityName = store.getState().location.locationCity.name; resolve({ orderId, amount, cinemaId, jbzFilmId, filmId, showId, cityId, cityName }); }, error =&gt; { reject(error); }); }) } /** * 确认订单 * @param type 平台类型 * @param lockSeatResultData 锁座成功返回的数据 * @returns {Promise} */ applyOrder(type, lockSeatResultData) { return new Promise((resolve, reject) =&gt; { this.confirmOrderHandlerFrom(type, lockSeatResultData).then(data =&gt; { resolve(data); }, error =&gt; { reject(error); }); }); } } export default TradeManager; × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Global Members &lt;constant&gt; cityUrl Created by cuppi on 2017/5/12. Source: src/differentiation/icbc.url.config.js &lt;constant&gt; cityUrl Created by cuppi on 2017/5/12. Source: src/differentiation/shanghai.url.config.js instance Created by cuppi on 2016/12/21. Source: src/arithmetic/AutoSeatPicking.js Methods other/jcombine(tasks) Parameters: Name Type Argument Description tasks &lt;repeatable&gt; Source: src/network/JNetworkFunc.js Returns: Type Jcombine other/jlink(tasks) 任务连接类 Parameters: Name Type Argument Description tasks &lt;repeatable&gt; Source: src/network/JNetworkFunc.js Returns: Type Jlink × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Classes Classes network/JNetwork network/JNetworkAccount network/JNetworkCinema network/JNetworkCity network/JNetworkConfig network/JNetworkFilm network/JNetworkMine network/JNetworkOther network/JNetworkTrade tool/JToolArray tool/JToolDate tool/JToolNumber tool/JToolObject tool/JToolString tool/JToolUrl util/JManagerSeat util/TradeManager × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink #JBZWebSDK JBZWebSDK is Shanghai jinbaozheng easy network technology Co.,Ltd internal use a SDK framework, it will be the company's internal all functional modules, the front-end engineer need tools such as packaged together, this is a powerful SDK, is very powerful, very powerful. × Search results Close "},"network_JNetwork.html":{"id":"network_JNetwork.html","title":"Class: network/JNetwork","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetwork network/JNetwork 网络请求类 new network/JNetwork() Source: src/network/JNetwork.js Methods &lt;static&gt; GET(url, parameters, headers) get请求 Parameters: Name Type Description url string 相对地址 parameters string 地址参数 headers string 头参数 Source: src/network/JNetwork.js Returns: 异步请求块 Type Promise &lt;static&gt; POST(url, parameters, headers) post请求 Parameters: Name Type Description url 相对地址 parameters 地址参数 headers 头参数 Source: src/network/JNetwork.js Returns: 异步请求块 Type Object | * × Search results Close "},"network_JNetworkAccount.html":{"id":"network_JNetworkAccount.html","title":"Class: network/JNetworkAccount","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkAccount network/JNetworkAccount 账户接口 new network/JNetworkAccount() Source: src/network/JNetworkAccount.js Methods &lt;static&gt; accountLogin(mobile, password) 用户登录 Parameters: Name Type Description mobile 登录需要的手机号码 password 登录需要的密码 Source: src/network/JNetworkAccount.js Returns: Type Object | * &lt;static&gt; accountLogout(sessionId) 用户登出 Parameters: Name Type Description sessionId 用户登录标识 Source: src/network/JNetworkAccount.js Returns: Type Object | * &lt;static&gt; accountRegister(mobile, verifyCode, password) 注册用户 Parameters: Name Type Description mobile 用户的手机号码 verifyCode 验证码 password 密码 Source: src/network/JNetworkAccount.js Returns: Type Object | * &lt;static&gt; accountUpdatepass(mobile, verfyCode, password) 忘记密码并且找回密码 Parameters: Name Type Description mobile 手机号码 verfyCode 验证码 password 新密码 Source: src/network/JNetworkAccount.js Returns: Type Object | * &lt;static&gt; accountVerifyCode(mobile, type) 获取验证码 Parameters: Name Type Description mobile 接收验证码的手机号码 type 验证码类型 （1：注册使用 2：忘记密码使用） Source: src/network/JNetworkAccount.js Returns: Type Object | * × Search results Close "},"network_JNetworkCinema.html":{"id":"network_JNetworkCinema.html","title":"Class: network/JNetworkCinema","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkCinema network/JNetworkCinema 影院接口 new network/JNetworkCinema() Source: src/network/JNetworkCinema.js Methods &lt;static&gt; cinemaCancelFavoriteCinemaNeedLogin(cinemaId) 取消收藏影院 Parameters: Name Type Description cinemaId 影院Id Source: src/network/JNetworkCinema.js Returns: Type Object | * &lt;static&gt; cinemaDetail(cinemaId) 获取影院详情 Parameters: Name Type Description cinemaId 影院ID Source: src/network/JNetworkCinema.js Returns: Type * &lt;static&gt; cinemaFavoriteCinemaNeedLogin(cinemaId, cinemaName) 收藏影院 Parameters: Name Type Description cinemaId 影院Id cinemaName 影院名字 Source: src/network/JNetworkCinema.js Returns: Type Object | * &lt;static&gt; cinemaList(location, cinemaFilter) 影院列表 Parameters: Name Type Description location cinemaFilter Source: src/network/JNetworkCinema.js Returns: Type Promise &lt;static&gt; cinemaListNeedLocation(cinemaFilter) 影院列表 Parameters: Name Type Description cinemaFilter 影片筛选条件 Source: src/network/JNetworkCinema.js Returns: Type Object | * &lt;static&gt; cinemaScreeningDateList(cinemaId, filmId) 获取指定影院排片日期安排 Parameters: Name Type Description cinemaId 影院Id filmId 影片Id Source: src/network/JNetworkCinema.js Returns: Type Object | * &lt;static&gt; cinemaScreeningFilmList(cinemaId) 获取指定影院排片 Parameters: Name Type Description cinemaId 影院Id Source: src/network/JNetworkCinema.js Returns: Type Object | * &lt;static&gt; cinemaScreeningItems(cinemaId, filmId, date) 获取指定影院排片放映厅安排 Parameters: Name Type Description cinemaId 影院Id filmId 影片Id date 日期（时间戳标示） Source: src/network/JNetworkCinema.js Returns: Type Object | * &lt;static&gt; cinemaSeats(type, paras) 实时座位图 Parameters: Name Type Description type 平台类型 （必须） paras （根据不同平台变化） Source: src/network/JNetworkCinema.js Returns: Type * &lt;static&gt; cinemaSmartSeats(type, paras) 智能实时座位图 Parameters: Name Type Description type 平台类型 （必须） paras （根据不同平台变化） Source: src/network/JNetworkCinema.js Returns: Type * × Search results Close "},"network_JNetworkCity.html":{"id":"network_JNetworkCity.html","title":"Class: network/JNetworkCity","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkCity network/JNetworkCity 城市及定位接口 new network/JNetworkCity() Source: src/network/JNetworkCity.js Methods &lt;static&gt; cityByCoordinate(coordinate) 通过经纬度获取城市 Parameters: Name Type Description coordinate 位置信息 Source: src/network/JNetworkCity.js Returns: Type * &lt;static&gt; cityById(cityId) 通过城市id获取城市 Parameters: Name Type Description cityId Source: src/network/JNetworkCity.js Returns: Type Object | * &lt;static&gt; cityDistrictList(cityId) + 获取地区列表 Parameters: Name Type Description cityId Source: src/network/JNetworkCity.js Returns: Type Object | * &lt;static&gt; cityHotList() 获取热门城市列表 Source: src/network/JNetworkCity.js Returns: Type Object | * &lt;static&gt; cityList() 获取城市列表 Source: src/network/JNetworkCity.js Returns: Type * &lt;static&gt; cityNeedCoordinate() + 通过经纬度获取城市（通过代理传递） Source: src/network/JNetworkCity.js Returns: Type Object | * × Search results Close "},"network_JNetworkConfig.html":{"id":"network_JNetworkConfig.html","title":"Class: network/JNetworkConfig","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkConfig network/JNetworkConfig 请求配置类 new network/JNetworkConfig() Source: src/network/JNetworkConfig.js × Search results Close "},"network_JNetworkFilm.html":{"id":"network_JNetworkFilm.html","title":"Class: network/JNetworkFilm","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkFilm network/JNetworkFilm 影片接口 new network/JNetworkFilm() Source: src/network/JNetworkFilm.js Methods &lt;static&gt; filmDateList(filmId, cityId) 获取影片排片日期列表 Parameters: Name Type Description filmId 影片Id cityId 城市Id Source: src/network/JNetworkFilm.js Returns: Type Promise &lt;static&gt; filmDetail(filmId, platform) 获取影片详情 Parameters: Name Type Default Description filmId 影片Id platform null 平台类型(默认使用jbz平台) Source: src/network/JNetworkFilm.js Returns: Type Promise &lt;static&gt; filmHotfilms(page) 获取热门电影 Parameters: Name Type Description page 分页模型 Source: src/network/JNetworkFilm.js Returns: Type Promise &lt;static&gt; filmHotfilmsSimple() 获取热门电影 Source: src/network/JNetworkFilm.js Returns: Type Object | * &lt;static&gt; filmWaitfilms(page) 获取待映电影 Parameters: Name Type Description page 页号 Source: src/network/JNetworkFilm.js Returns: Type Promise × Search results Close "},"network_JNetworkMine.html":{"id":"network_JNetworkMine.html","title":"Class: network/JNetworkMine","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkMine network/JNetworkMine 个人中心接口 new network/JNetworkMine() Source: src/network/JNetworkMine.js Methods &lt;static&gt; mineFavoriteNeedLogin() 我的收藏 Source: src/network/JNetworkMine.js Returns: Type * &lt;static&gt; mineOrderNeedLogin() 我的订单 Source: src/network/JNetworkMine.js Returns: Type * × Search results Close "},"network_JNetworkOther.html":{"id":"network_JNetworkOther.html","title":"Class: network/JNetworkOther","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkOther network/JNetworkOther 其他接口 new network/JNetworkOther() Source: src/network/JNetworkOther.js Methods &lt;static&gt; hotQuery() 热搜词汇 Source: src/network/JNetworkOther.js Returns: Type Object | * &lt;static&gt; otherBanners() 广告接口 Source: src/network/JNetworkOther.js Returns: Type Object | * &lt;static&gt; otherSearch(cityId, key, lastKey) 搜索 Parameters: Name Type Description cityId 城市Id key 关键字 lastKey 下一页的句柄 Source: src/network/JNetworkOther.js Returns: Type Object | * × Search results Close "},"network_JNetworkTrade.html":{"id":"network_JNetworkTrade.html","title":"Class: network/JNetworkTrade","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: network/JNetworkTrade network/JNetworkTrade 交易接口 new network/JNetworkTrade() Source: src/network/JNetworkTrade.js Methods &lt;static&gt; cancelLockSeatNeedLogin(orderId) 取消锁座 Parameters: Name Type Description orderId 订单Id Source: src/network/JNetworkTrade.js Returns: Type Object | * &lt;static&gt; tradeApplyOrderNeedLogin(type, paras) 下订单 Parameters: Name Type Description type 平台类型 paras 下订单参数 Source: src/network/JNetworkTrade.js Returns: Type Object | * &lt;static&gt; tradeLockSeatNeedLogin(type, paras) 锁座 Parameters: Name Type Description type 平台类型 paras 锁座参数 Source: src/network/JNetworkTrade.js Returns: Type Object | * &lt;static&gt; tradePrePayOrderNeedLoginInType(orderId, payType, prizeIds, redIds) 申请预订单 Parameters: Name Type Description orderId 订单Id payType 支付类型 prizeIds 待定 redIds 待定 Source: src/network/JNetworkTrade.js Returns: Type Object | * × Search results Close "},"tool_JToolArray.html":{"id":"tool_JToolArray.html","title":"Class: tool/JToolArray","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: tool/JToolArray tool/JToolArray 数组工具类 new tool/JToolArray() Source: src/tool/JToolArray.js × Search results Close "},"tool_JToolDate.html":{"id":"tool_JToolDate.html","title":"Class: tool/JToolDate","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: tool/JToolDate tool/JToolDate 时间工具类 new tool/JToolDate() Source: src/tool/JToolDate.js Methods &lt;static&gt; currentDate() 获取当前日期对象 Source: src/tool/JToolDate.js Returns: Type Date &lt;static&gt; currentDateString() 获取当前日期字符串 Source: src/tool/JToolDate.js Returns: Type Date &lt;static&gt; currentTimeInterval() 获取当前时间戳 Source: src/tool/JToolDate.js Returns: Type number &lt;static&gt; dateFromDateString(dateString, format) 获取字符串的指定格式的日期 （待开发） Parameters: Name Type Description dateString 日期字符串 format 日期格式 Source: src/tool/JToolDate.js Returns: Type Date &lt;static&gt; dateFromTimeInterval(timeInterval) 时间戳转换日期 Parameters: Name Type Description timeInterval 时间戳 Source: src/tool/JToolDate.js Returns: 日期 Type Date &lt;static&gt; dateSeveralDaysLater(beganDate, days) 指定日期的某天后 Parameters: Name Type Description beganDate days Source: src/tool/JToolDate.js Returns: Type string &lt;static&gt; dateStringFromDate(date, format) 获取日期的指定格式的字符串 Parameters: Name Type Description date Date对象 format 格式化信息 Source: src/tool/JToolDate.js &lt;static&gt; dateStringFromTimeInterval(timeInterval, format) 时间戳转换日期字符串 Parameters: Name Type Description timeInterval 时间戳 format 日期格式 如: yyyy-MM-dd hh:mm:ss Source: src/tool/JToolDate.js Returns: Type * &lt;static&gt; dateStringSeveralDaysLater(beganDateString, days, format) 指定日期字符串的某天后 Parameters: Name Type Description beganDateString 标准日期字符串 days 天数 format 日期格式化 Source: src/tool/JToolDate.js Returns: Type string &lt;static&gt; distanceBetweenDate(startDate, endDate, justSeconds) 时间戳的距离 Parameters: Name Type Description startDate 起始日期 endDate 结束日期 justSeconds 只需要秒的总数 Source: src/tool/JToolDate.js Returns: [秒，分，小时，天，月, 年] Type Array &lt;static&gt; distanceBetweenDateString(startDateString, endDateString, justSeconds) 时间戳的距离 Parameters: Name Type Description startDateString 起始日期字符串 endDateString 结束日期字符串 justSeconds 只需要秒的总数 Source: src/tool/JToolDate.js Returns: [秒，分，小时，天，月, 年] Type Array &lt;static&gt; distanceBetweenTimeInterval(startTimeInterval, endTimeInterval, justSeconds) 时间戳的距离 Parameters: Name Type Description startTimeInterval 起始时间戳 endTimeInterval 结束时间戳 justSeconds 只需要秒的总数 Source: src/tool/JToolDate.js Returns: [秒，分，小时，天，月, 年] Type Array &lt;static&gt; timeIntervalFromDate(date) 日期转换时间戳 Parameters: Name Type Description date 日期 Source: src/tool/JToolDate.js Returns: Type number &lt;static&gt; timeIntervalFromDateString(dateString) 日期字符串转换时间戳 注：时间格式需满足Date规范 如 2017-05-23 18:56:00、2017/05/23 Parameters: Name Type Description dateString 日期 Source: src/tool/JToolDate.js Returns: Type number &lt;static&gt; transformDateStringByFormat(dateString, fromFormat, toFormat) 变换日期字符串格式 （待开发） Parameters: Name Type Description dateString 日期字符串 fromFormat 输入格式 toFormat 输出格式 Source: src/tool/JToolDate.js Returns: Type * &lt;static&gt; weekDayFromDate(date) 获取指定日期为星期几 Parameters: Name Type Description date 日期对象 Source: src/tool/JToolDate.js Returns: 0~6 星期一~星期日 Type number &lt;static&gt; weekDayFromDateString(dateString, format) 获取指定日期字符串为星期几 Parameters: Name Type Description dateString 标准日期字符串 format 日期格式 Source: src/tool/JToolDate.js Returns: 0~6 星期一~星期日 Type number × Search results Close "},"tool_JToolNumber.html":{"id":"tool_JToolNumber.html","title":"Class: tool/JToolNumber","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: tool/JToolNumber tool/JToolNumber 数字工具类 new tool/JToolNumber() Source: src/tool/JToolNumber.js Methods &lt;static&gt; fixDigits(number, digits) 小数部分有效数字保留 Parameters: Name Type Description number 数字 digits 小数保留位数 Source: src/tool/JToolNumber.js Returns: 数字的字符串 Type string &lt;static&gt; positiveText(number, text) 返回正整数的字符串（非正整数返回指定字符串或空字符串） Parameters: Name Type Description number 数字 text 非正整数的返回（可空） Source: src/tool/JToolNumber.js Returns: Type * &lt;static&gt; zeroPad(number, length) 整数补0 Parameters: Name Type Description number 整数 length 最终的长度 Source: src/tool/JToolNumber.js Returns: 整数字符串 Type * | Blob | string | ArrayBuffer | Array.&lt;T&gt; × Search results Close "},"tool_JToolObject.html":{"id":"tool_JToolObject.html","title":"Class: tool/JToolObject","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: tool/JToolObject tool/JToolObject 对象工具类 new tool/JToolObject() Source: src/tool/JToolObject.js Methods &lt;static&gt; deleteProperty(target, propertyKey) 删除对象某个属性 Parameters: Name Type Description target 对象 propertyKey 属性 Source: src/tool/JToolObject.js Returns: Type boolean × Search results Close "},"tool_JToolString.html":{"id":"tool_JToolString.html","title":"Class: tool/JToolString","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: tool/JToolString tool/JToolString 字符串工具类 new tool/JToolString() Source: src/tool/JToolString.js Methods &lt;static&gt; clearClutter(string) 清除所有特殊字符 Parameters: Name Type Description string 字符串 Source: src/tool/JToolString.js Returns: Type * &lt;static&gt; clearComma(string) 清除所有逗号 Parameters: Name Type Description string 字符串 Source: src/tool/JToolString.js &lt;static&gt; clearSpace(string) 清除所有空格字符 Parameters: Name Type Description string 字符串 Source: src/tool/JToolString.js &lt;static&gt; clearVertical(string) 清除所有竖线 Parameters: Name Type Description string 字符串 Source: src/tool/JToolString.js &lt;static&gt; isEmail(email) 检验是否为邮箱 Parameters: Name Type Description email Source: src/tool/JToolString.js &lt;static&gt; isEmpty(string) 校验是否为空字符串 Parameters: Name Type Description string Source: src/tool/JToolString.js Returns: Type boolean &lt;static&gt; isMobile(mobile) 校验是否为手机号码 Parameters: Name Type Description mobile 手机号码 Source: src/tool/JToolString.js Returns: Type boolean &lt;static&gt; isPassword(password, minLength, maxLength) 校验是否为密码 Parameters: Name Type Description password 密码 minLength 最小长度 maxLength 最大长度 Source: src/tool/JToolString.js Returns: Type boolean &lt;static&gt; isPhoneNumber(phone) 校验是否为电话号码 Parameters: Name Type Description phone Source: src/tool/JToolString.js Returns: Type boolean &lt;static&gt; isVerifyCode(verifycode) 校验是否为验证码（即0~9 6位数字） Parameters: Name Type Description verifycode Source: src/tool/JToolString.js Returns: Type boolean &lt;static&gt; numberFromASC(ascChar) 通过asc得出字符数值 Parameters: Name Type Description ascChar Source: src/tool/JToolString.js Returns: Type Number &lt;static&gt; numberFromString(string, force) 转换字符串到数字 Parameters: Name Type Description string 字符串 force 是否强制转换非数字字符 (即为26进制数字) Source: src/tool/JToolString.js Returns: Type number × Search results Close "},"tool_JToolUrl.html":{"id":"tool_JToolUrl.html","title":"Class: tool/JToolUrl","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: tool/JToolUrl tool/JToolUrl 网络地址工具类 new tool/JToolUrl() Source: src/tool/JToolUrl.js Methods &lt;static&gt; urlFromPortion(baseUrl, subUrl, parameters) 合成URL完整地址 Parameters: Name Type Description baseUrl 基础地址 subUrl 相对地址 parameters 参数 Source: src/tool/JToolUrl.js Returns: 返回拼接后的地址 Type * × Search results Close "},"util_JManagerSeat.html":{"id":"util_JManagerSeat.html","title":"Class: util/JManagerSeat","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: util/JManagerSeat util/JManagerSeat 座位图管理类 new util/JManagerSeat() 构造器 Source: src/util/JManagerSeat.js Methods &lt;static&gt; defaultManager() 单例方法 Source: src/util/JManagerSeat.js Returns: Type SeatManager &lt;static&gt; seatParasFromScreening(platform, screening) 获取座位图时需要的参数 Parameters: Name Type Description platform 平台类型 screening 平台数据 Source: src/util/JManagerSeat.js Returns: 平台需要的参数 Type Object &lt;static&gt; smartAutoSelected(smartSeats, count) 智能选座 Parameters: Name Type Description smartSeats count Source: src/util/JManagerSeat.js Returns: Type Promise smartSeatDataFromSeats(type, seatData) 对原始座位图进行智能转换 Parameters: Name Type Description type 平台类型 seatData 座位图原始数据 Source: src/util/JManagerSeat.js Returns: 智能座位图详细信息 Type Object smartSeatDataFromSmartSeats(type, smartSeats) 获取智能座位图元数据 Parameters: Name Type Description type 平台类型 smartSeats 智能座位图 Source: src/util/JManagerSeat.js Returns: 智能座位图详细信息 Type Object smartSeatsFromSeats(type, seatData) 对原始座位图进行智能转换 Parameters: Name Type Description type 平台类型 seatData 座位图原始数据 Source: src/util/JManagerSeat.js Returns: 智能座位图列表 Type Array × Search results Close "},"util_TradeManager.html":{"id":"util_TradeManager.html","title":"Class: util/TradeManager","body":" JBZWebSDK Classes network/JNetworknetwork/JNetworkAccountnetwork/JNetworkCinemanetwork/JNetworkCitynetwork/JNetworkConfignetwork/JNetworkFilmnetwork/JNetworkMinenetwork/JNetworkOthernetwork/JNetworkTradetool/JToolArraytool/JToolDatetool/JToolNumbertool/JToolObjecttool/JToolStringtool/JToolUrlutil/JManagerSeatutil/TradeManager Global cityUrlinstanceother/jcombineother/jlink Class: util/TradeManager util/TradeManager 交易管理类 new util/TradeManager() Source: src/util/JManagerTrade.js Methods &lt;static&gt; defaultManager() 获取单例实例 Source: src/util/JManagerTrade.js Returns: Type TradeManager &lt;static&gt; tradeParasFromPlatform(platform, platformData, filmId, filmName, cinemaId, cinemaName) 获取交易商务参数（与座位无关的） Parameters: Name Type Description platform 平台类型 platformData 平台数据 filmId 电影Id filmName 电影名称 cinemaId 影院Id cinemaName 影院名称 Source: src/util/JManagerTrade.js Returns: 商务参数 Type * applyOrder(type, lockSeatResultData) 确认订单 Parameters: Name Type Description type 平台类型 lockSeatResultData 锁座成功返回的数据 Source: src/util/JManagerTrade.js Returns: Type Promise buyTicket(type, tradeParas, seatList, mobile, openId) 购票（执行锁座 下订单 的事务） Parameters: Name Type Description type 平台类型 tradeParas 商务参数（与座位无关的参数集合） seatList 座位列表 mobile 手机号码 openId 身份标识符（同上） Source: src/util/JManagerTrade.js Returns: 返回请求promise Type * confirmOrderHandlerFrom(type, paras) 获取下订单处理者 Parameters: Name Type Description type 平台类型 paras 参数 Source: src/util/JManagerTrade.js Returns: 返回请求promise Type Object | * lockSeat(type, tradeParas, seatList, mobile) 锁座 Parameters: Name Type Description type 平台类型 tradeParas 商务参数（与座位无关的参数集合） seatList 座位列表 mobile 手机号码 Source: src/util/JManagerTrade.js Returns: 返回请求promise Type Promise lockSeatHandlerFrom(type, paras) 获取锁座处理者 Parameters: Name Type Description type 平台类型 paras 参数 Source: src/util/JManagerTrade.js Returns: 返回请求promise Type * seatInforParas(type, seatList, mobile, openId) 获取锁座时需要的座位参数 Parameters: Name Type Description type 平台类型 seatList 座位列表（需要购买的） mobile 手机号码 openId 身份标识符（目前跟手机号码一样） Source: src/util/JManagerTrade.js Returns: 返回参数对象 Type * × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
