{"version":3,"sources":["network/JNetworkFunc.js"],"names":["Object","defineProperty","exports","value","Jpara","paras","_i","arguments","length","_paras","_a","paras_1","para","push","isJpara","prototype","items","emptyPara","Jtask","task","parasPicker","resolve","reject","_task","_resolve","_reject","_parasPicker","setNextTask","_nextTask","do","_this","apply","paraItems","then","data","nextPara","concat","error","console","log","name","Jlink","tasks","_tasks","tasks_1","_taskIndex","_headTaskPara","_allTaskPara","next","nextTask","_headTask","run","index","Jcombine","tasks_2","jlink","bind","jpara","jcombine"],"mappings":"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","file":"JNetworkFunc.js","sourcesContent":["\"use strict\";\n/**\n * Created by cuppi on 2017/5/9.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @private\n */\nvar Jpara = (function () {\n    function Jpara() {\n        var paras = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            paras[_i] = arguments[_i];\n        }\n        this._paras = [];\n        for (var _a = 0, paras_1 = paras; _a < paras_1.length; _a++) {\n            var para = paras_1[_a];\n            this._paras.push(para);\n        }\n        this.isJpara = true;\n    }\n    Jpara.prototype.items = function () {\n        return this._paras;\n    };\n    Jpara.emptyPara = function () {\n        return new Jpara();\n    };\n    return Jpara;\n}());\n/**\n * 辅助任务类\n * @private\n */\nvar Jtask = (function () {\n    function Jtask(task, parasPicker, resolve, reject) {\n        this._task = task;\n        this._resolve = resolve;\n        this._reject = reject;\n        this._parasPicker = parasPicker;\n    }\n    Jtask.prototype.setNextTask = function (task) {\n        this._nextTask = task;\n    };\n    Jtask.prototype.do = function (paras) {\n        var _this = this;\n        paras = paras ? paras : this._parasPicker();\n        this._task.apply(this, this.paraItems(paras)).then(function (data) {\n            var nextPara = _this._resolve.apply(_this, [data].concat(_this.paraItems(paras)));\n            if (_this._nextTask) {\n                _this._nextTask.do(nextPara);\n            }\n        }, function (error) {\n            if (_this._reject) {\n                _this._reject.apply(_this, [error].concat(_this.paraItems(paras)));\n            }\n            else {\n                console.log('ERROR: Don\\'t find the error handler for task (' + _this._task.name + ')');\n            }\n        });\n    };\n    Jtask.prototype.paraItems = function (nextPara) {\n        if (nextPara && nextPara.isJpara) {\n            return nextPara.items();\n        }\n        return Jpara.emptyPara().items();\n    };\n    return Jtask;\n}());\n/**\n *\n * 任务连接类\n * @private\n */\nvar Jlink = (function () {\n    function Jlink() {\n        var tasks = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            tasks[_i] = arguments[_i];\n        }\n        this._tasks = [];\n        for (var _a = 0, tasks_1 = tasks; _a < tasks_1.length; _a++) {\n            var task = tasks_1[_a];\n            this._tasks.push(task);\n        }\n        this._taskIndex = 0;\n    }\n    Jlink.prototype.para = function (para) {\n        this._headTaskPara = para;\n        return this;\n    };\n    Jlink.prototype.paras = function () {\n        var paras = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            paras[_i] = arguments[_i];\n        }\n        this._allTaskPara = paras;\n        return this;\n    };\n    Jlink.prototype.next = function (resolve, reject) {\n        if (this._taskIndex >= this._tasks.length) {\n            return this;\n        }\n        var nextTask = new Jtask(this._tasks[this._taskIndex], this._parasPicker(this._taskIndex), resolve, reject);\n        this._taskIndex++;\n        if (this._nextTask) {\n            this._nextTask.setNextTask(nextTask);\n        }\n        else {\n            this._headTask = nextTask;\n        }\n        this._nextTask = nextTask;\n        return this;\n    };\n    Jlink.prototype.run = function () {\n        this._headTask.do(this._parasPicker(0)());\n        return this;\n    };\n    /**\n     * 指定任务的paras的获取者 (目前实现会浪费内存，多个相同函数推入函数栈，后期优化）\n     * @returns {Array}\n     * @private\n     */\n    Jlink.prototype._parasPicker = function (index) {\n        var _this = this;\n        return function () {\n            if (_this._allTaskPara && _this._allTaskPara.length > index) {\n                return _this._allTaskPara[index];\n            }\n            if (index === 0 && _this._headTaskPara) {\n                return _this._headTaskPara;\n            }\n            return Jpara.emptyPara();\n        };\n    };\n    return Jlink;\n}());\n/**\n * 任务组合类\n * @private\n */\nvar Jcombine = (function () {\n    function Jcombine() {\n        var tasks = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            tasks[_i] = arguments[_i];\n        }\n        this._tasks = [];\n        for (var _a = 0, tasks_2 = tasks; _a < tasks_2.length; _a++) {\n            var task = tasks_2[_a];\n            this._tasks.push(task);\n        }\n        this._taskIndex = 0;\n    }\n    Jcombine.prototype.para = function (para) {\n        this._headTaskPara = para;\n        return this;\n    };\n    Jcombine.prototype.paras = function () {\n        var paras = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            paras[_i] = arguments[_i];\n        }\n        this._allTaskPara = paras;\n        return this;\n    };\n    Jcombine.prototype.next = function (resolve, reject) {\n        if (this._taskIndex >= this._tasks.length) {\n            return this;\n        }\n        var nextTask = new Jtask(this._tasks[this._taskIndex], this._parasPicker(this._taskIndex), resolve, reject);\n        this._taskIndex++;\n        if (this._nextTask) {\n            this._nextTask.setNextTask(nextTask);\n        }\n        else {\n            this._headTask = nextTask;\n        }\n        this._nextTask = nextTask;\n        return this;\n    };\n    Jcombine.prototype.run = function () {\n        this._headTask.do(this._parasPicker(0)());\n        return this;\n    };\n    return Jcombine;\n}());\n/**\n * 任务连接类\n * @alias other/jlink\n * @param tasks\n * @returns {Jlink}\n */\nfunction jlink() {\n    var tasks = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        tasks[_i] = arguments[_i];\n    }\n    return new (Jlink.bind.apply(Jlink, [void 0].concat(tasks)))();\n}\nexports.jlink = jlink;\n/**\n * @private\n * @param paras\n * @returns {Jpara}\n */\nfunction jpara() {\n    var paras = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        paras[_i] = arguments[_i];\n    }\n    return new (Jpara.bind.apply(Jpara, [void 0].concat(paras)))();\n}\nexports.jpara = jpara;\n/**\n * @alias other/jcombine\n * @param tasks\n * @returns {Jcombine}\n */\nfunction jcombine() {\n    var tasks = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        tasks[_i] = arguments[_i];\n    }\n    return new (Jcombine.bind.apply(Jcombine, [void 0].concat(tasks)))();\n}\n"]}