{"version":3,"sources":["util/JManagerTrade.js"],"names":["__assign","t","s","i","n","arguments","length","p","Object","prototype","hasOwnProperty","call","defineProperty","exports","value","JNetworkTrade_js_1","require","instance","TradeManager","defaultManager","tradeParasFromPlatform","platform","platformData","filmId","filmName","cinemaId","cinemaName","jbzFilmId","showId","showIndex","platformCinemaId","foretellId","id","seqid","lockSeatHandlerFrom","type","paras","default","tradeLockSeatNeedLogin","confirmOrderHandlerFrom","tradeConfirmOrderNeedLogin","seatInforParas","seatList","mobile","seatInfos","seatNumberInfos","_i","seatList_1","seat","push","seatModel","SeatIndex","rowNumber","colNumber","seatIds","join","count","openId","_a","seatList_2","rowId","columnId","_b","seatList_3","_c","seatList_4","_d","seatList_5","console","log","sectionId","seatNo","list","_e","seatList_6","buyTicket","tradeParas","bridgeSelf","next","lockSeatCallback","confirmOrderCallback","then","data","orderId","cityId","store","getState","location","locationCity","cityName","name","error","lockSeat","_this","resolve","reject","amount","originalAmount","applyOrder","lockSeatResultData"],"mappings":"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","file":"JManagerTrade.js","sourcesContent":["/**\n * Created by cuppi on 2016/12/7.\n */\n'use strict';\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar JNetworkTrade_js_1 = require(\"../network/JNetworkTrade.js\");\nvar instance = null;\n/**\n * 交易管理类\n * @memberOf module:manager\n */\nvar TradeManager = (function () {\n    function TradeManager() {\n        if (!instance) {\n            instance = this;\n        }\n        return instance;\n    }\n    /**\n     * 获取单例实例\n     * @returns {TradeManager}\n     */\n    TradeManager.defaultManager = function () {\n        return new TradeManager();\n    };\n    /**\n     * 获取交易商务参数（与座位无关的）\n     * @param platform 平台类型\n     * @param platformData 平台数据\n     * @param filmId 电影Id\n     * @param filmName 电影名称\n     * @param cinemaId 影院Id\n     * @param cinemaName 影院名称\n     * @returns {*} 商务参数\n     */\n    TradeManager.tradeParasFromPlatform = function (platform, platformData, filmId, filmName, cinemaId, cinemaName) {\n        if (platform === 'wangpiao') {\n            return {\n                jbzFilmId: filmId,\n                filmId: platformData.filmId,\n                showId: platformData.showIndex,\n                cinemaName: cinemaName,\n                platformCinemaId: platformData.cinemaId,\n                cinemaId: cinemaId\n            };\n        }\n        if (platform === 'spider') {\n            return {\n                jbzFilmId: filmId,\n                filmId: platformData.filmId,\n                showId: platformData.showId,\n                platformCinemaId: platformData.cinemaId,\n                cinemaId: cinemaId\n            };\n        }\n        if (platform === 'maizuo') {\n            return {\n                jbzFilmId: filmId,\n                filmId: platformData.filmId,\n                showId: platformData.foretellId,\n                filmName: filmName,\n                cinemaName: cinemaName,\n                platformCinemaId: platformData.cinemaId,\n                cinemaId: cinemaId\n            };\n        }\n        if (platform === 'danche') {\n            return {\n                jbzFilmId: filmId,\n                filmId: platformData.filmId,\n                showId: platformData.id,\n                platformCinemaId: platformData.cinemaId,\n                cinemaId: cinemaId\n            };\n        }\n        if (platform === 'maoyan' || platform === 'meituan' || platform === 'dazhong') {\n            return {\n                jbzFilmId: filmId,\n                filmId: platformData.filmId,\n                showId: platformData.showId,\n                cinemaName: cinemaName,\n                platformCinemaId: platformData.cinemaId,\n                cinemaId: cinemaId\n            };\n        }\n        if (platform === 'baidu') {\n            return {\n                showId: platformData.seqid,\n                platformCinemaId: platformData.cinemaId,\n                cinemaId: cinemaId\n            };\n        }\n    };\n    /**\n     * 获取锁座处理者\n     * @param type 平台类型\n     * @param paras 参数\n     * @returns {*} 返回请求promise\n     */\n    TradeManager.prototype.lockSeatHandlerFrom = function (type, paras) {\n        return JNetworkTrade_js_1.default.tradeLockSeatNeedLogin(type, paras);\n    };\n    /**\n     * 获取下订单处理者\n     * @param type 平台类型\n     * @param paras 参数\n     * @returns {{terminate, then}|*} 返回请求promise\n     */\n    TradeManager.prototype.confirmOrderHandlerFrom = function (type, paras) {\n        return JNetworkTrade_js_1.default.tradeConfirmOrderNeedLogin(type, paras);\n    };\n    /**\n     * 获取锁座时需要的座位参数\n     * @param type 平台类型\n     * @param seatList 座位列表（需要购买的）\n     * @param mobile 手机号码\n     * @param openId 身份标识符（目前跟手机号码一样）\n     * @returns {*} 返回参数对象\n     */\n    TradeManager.prototype.seatInforParas = function (type, seatList, mobile) {\n        // 网票\n        if (type === 'wangpiao') {\n            var seatInfos = [];\n            var seatNumberInfos = [];\n            for (var _i = 0, seatList_1 = seatList; _i < seatList_1.length; _i++) {\n                var seat = seatList_1[_i];\n                seatInfos.push(seat.seatModel.SeatIndex);\n                seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber);\n            }\n            return {\n                seatIds: seatInfos.join('|'),\n                count: seatInfos.length,\n                seatNumberInfos: seatNumberInfos.join('|'),\n                mobile: mobile,\n                openId: openId\n            };\n        }\n        // 蜘蛛\n        if (type === 'spider') {\n            var seatInfos = [];\n            var seatNumberInfos = [];\n            for (var _a = 0, seatList_2 = seatList; _a < seatList_2.length; _a++) {\n                var seat = seatList_2[_a];\n                seatInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId);\n                seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber);\n            }\n            return {\n                seatIds: seatInfos.join('|'),\n                count: seatInfos.length,\n                seatNumberInfos: seatNumberInfos.join('|'),\n                mobile: mobile,\n                openId: openId\n            };\n        }\n        // 卖座\n        if (type === 'maizuo') {\n            var seatInfos = [];\n            var seatNumberInfos = [];\n            for (var _b = 0, seatList_3 = seatList; _b < seatList_3.length; _b++) {\n                var seat = seatList_3[_b];\n                seatInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId);\n                seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber);\n            }\n            return {\n                seatIds: seatInfos.join('|'),\n                count: seatInfos.length,\n                seatNumberInfos: seatNumberInfos.join('|'),\n                mobile: mobile,\n                openId: openId\n            };\n        }\n        // 单车\n        if (type === 'danche') {\n            var seatInfos = [];\n            var seatNumberInfos = [];\n            for (var _c = 0, seatList_4 = seatList; _c < seatList_4.length; _c++) {\n                var seat = seatList_4[_c];\n                seatInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId);\n                seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber);\n            }\n            return {\n                seatIds: seatInfos.join('|'),\n                count: seatInfos.length,\n                seatNumberInfos: seatNumberInfos.join('|'),\n                mobile: mobile,\n                openId: openId\n            };\n        }\n        // 猫眼\n        if (type === 'maoyan' || type === 'meituan' || type === 'dazhong') {\n            var seatInfos = [];\n            var seatNumberInfos = [];\n            for (var _d = 0, seatList_5 = seatList; _d < seatList_5.length; _d++) {\n                var seat = seatList_5[_d];\n                if (!seat.seatModel || true) {\n                    console.log(seat);\n                }\n                console.log(seat.seatModel);\n                seatInfos.push({\n                    sectionId: seat.seatModel.sectionId,\n                    columnId: seat.seatModel.columnId,\n                    rowId: seat.seatModel.rowId,\n                    seatNo: seat.seatModel.seatNo\n                });\n                seatNumberInfos.push(seat.rowNumber + ':' + seat.colNumber);\n            }\n            return {\n                seatIds: JSON.stringify({\n                    count: seatList.length,\n                    list: seatInfos\n                }),\n                seatNumberInfos: seatNumberInfos.join('|'),\n                mobile: mobile,\n                openId: openId\n            };\n        }\n        // 百度\n        if (type === 'baidu') {\n            var seatIds = [];\n            var seatNumberInfos = [];\n            for (var _e = 0, seatList_6 = seatList; _e < seatList_6.length; _e++) {\n                var seat = seatList_6[_e];\n                seatIds.push(seat.seatModel.seatNo);\n                seatNumberInfos.push(seat.seatModel.rowId + ':' + seat.seatModel.columnId);\n            }\n            return {\n                count: seatIds.length,\n                //  后台设置特意反过来的\n                seatIds: seatNumberInfos.join('|'),\n                seatNumberInfos: seatIds.join('|'),\n                mobile: mobile,\n                openId: openId\n            };\n        }\n    };\n    /**\n     * 购票（执行锁座 下订单 的事务）\n     * @param type 平台类型\n     * @param tradeParas 商务参数（与座位无关的参数集合）\n     * @param seatList 座位列表\n     * @param mobile 手机号码\n     * @param openId 身份标识符（同上）\n     * @returns {*} 返回请求promise\n     */\n    TradeManager.prototype.buyTicket = function (type, tradeParas, seatList, mobile) {\n        var paras = __assign({}, tradeParas, this.seatInforParas(type, seatList, mobile));\n        var bridgeSelf = this;\n        return {\n            next: function (lockSeatCallback) {\n                return {\n                    next: function (confirmOrderCallback) {\n                        bridgeSelf.lockSeatHandlerFrom(type, __assign({}, paras, { cinemaId: paras.platformCinemaId })).then(function (data) {\n                            lockSeatCallback(null, data);\n                            var orderId = data.orderId;\n                            var cinemaId = paras.cinemaId, jbzFilmId = paras.jbzFilmId, filmId = paras.filmId, showId = paras.showId;\n                            var cityId = store.getState().location.locationCity.id;\n                            var cityName = store.getState().location.locationCity.name;\n                            bridgeSelf.confirmOrderHandlerFrom(type, {\n                                orderId: orderId,\n                                cinemaId: cinemaId,\n                                jbzFilmId: jbzFilmId,\n                                filmId: filmId,\n                                showId: showId,\n                                cityId: cityId,\n                                cityName: cityName\n                            }).then(function (data) {\n                                confirmOrderCallback(null, data);\n                            }, function (error) {\n                                confirmOrderCallback(error, null);\n                            });\n                        }, function (error) {\n                            lockSeatCallback(error, null);\n                        });\n                    }\n                };\n            }\n        };\n    };\n    /**\n     * 锁座\n     * @param type 平台类型\n     * @param tradeParas 商务参数（与座位无关的参数集合）\n     * @param seatList 座位列表\n     * @param mobile 手机号码\n     * @returns {Promise} 返回请求promise\n     */\n    TradeManager.prototype.lockSeat = function (type, tradeParas, seatList, mobile) {\n        var _this = this;\n        var paras = __assign({}, tradeParas, this.seatInforParas(type, seatList, mobile));\n        return new Promise(function (resolve, reject) {\n            _this.lockSeatHandlerFrom(type, __assign({}, paras, { cinemaId: paras.platformCinemaId })).then(function (data) {\n                var orderId = data.orderId;\n                var amount = data.originalAmount;\n                var cinemaId = paras.cinemaId, jbzFilmId = paras.jbzFilmId, filmId = paras.filmId, showId = paras.showId;\n                // 下面两个\n                var cityId = store.getState().location.locationCity.id;\n                var cityName = store.getState().location.locationCity.name;\n                resolve({\n                    orderId: orderId,\n                    amount: amount,\n                    cinemaId: cinemaId,\n                    jbzFilmId: jbzFilmId,\n                    filmId: filmId,\n                    showId: showId,\n                    cityId: cityId,\n                    cityName: cityName\n                });\n            }, function (error) {\n                reject(error);\n            });\n        });\n    };\n    /**\n     * 确认订单\n     * @param type 平台类型\n     * @param lockSeatResultData 锁座成功返回的数据\n     * @returns {Promise}\n     */\n    TradeManager.prototype.applyOrder = function (type, lockSeatResultData) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            _this.confirmOrderHandlerFrom(type, lockSeatResultData).then(function (data) {\n                resolve(data);\n            }, function (error) {\n                reject(error);\n            });\n        });\n    };\n    return TradeManager;\n}());\nexports.default = TradeManager;\n"]}